/*
 MIT license
 @link http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136
*/
var Stats=function(){function f(a,e,b){a=document.createElement(a);a.id=e;a.style.cssText=b;return a}function l(a,e,b){var c=f("div",a,"padding:0 0 3px 3px;text-align:left;background:"+b),d=f("div",a+"Text","font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px;color:"+e);d.innerHTML=a.toUpperCase();c.appendChild(d);a=f("div",a+"Graph","width:74px;height:30px;background:"+e);c.appendChild(a);for(e=0;74>e;e++)a.appendChild(f("span","","width:1px;height:30px;float:left;opacity:0.9;background:"+
b));return c}function m(a){for(var b=c.children,d=0;d<b.length;d++)b[d].style.display=d===a?"block":"none";n=a}function p(a,b){a.appendChild(a.firstChild).style.height=Math.min(30,30-30*b)+"px"}var q=self.performance&&self.performance.now?self.performance.now.bind(performance):Date.now,k=q(),r=k,t=0,n=0,c=f("div","stats","width:80px;opacity:0.9;cursor:pointer");c.addEventListener("mousedown",function(a){a.preventDefault();m(++n%c.children.length)},!1);var d=0,u=Infinity,v=0,b=l("fps","#0ff","#002"),
A=b.children[0],B=b.children[1];c.appendChild(b);var g=0,w=Infinity,x=0,b=l("ms","#0f0","#020"),C=b.children[0],D=b.children[1];c.appendChild(b);if(self.performance&&self.performance.memory){var h=0,y=Infinity,z=0,b=l("mb","#f08","#201"),E=b.children[0],F=b.children[1];c.appendChild(b)}m(n);return{REVISION:14,domElement:c,setMode:m,begin:function(){k=q()},end:function(){var a=q();g=a-k;w=Math.min(w,g);x=Math.max(x,g);C.textContent=(g|0)+" MS ("+(w|0)+"-"+(x|0)+")";p(D,g/200);t++;if(a>r+1E3&&(d=Math.round(1E3*
t/(a-r)),u=Math.min(u,d),v=Math.max(v,d),A.textContent=d+" FPS ("+u+"-"+v+")",p(B,d/100),r=a,t=0,void 0!==h)){var b=performance.memory.usedJSHeapSize,c=performance.memory.jsHeapSizeLimit;h=Math.round(9.54E-7*b);y=Math.min(y,h);z=Math.max(z,h);E.textContent=h+" MB ("+y+"-"+z+")";p(F,b/c)}return a},update:function(){k=this.end()}}};"object"===typeof module&&(module.exports=Stats);var artemis;
(function(artemis){function getClassName(klass){return klass.className||klass.name}artemis.getClassName=getClassName})(artemis||(artemis={}));(function(root,factory){if("function"===typeof define&&define.amd)define(factory);else if("object"===typeof exports)module.exports["artemis"]=factory();else root["artemis"]=factory()})(this,function(){return artemis});var artemis;
(function(artemis){var signals;(function(signals){var ListenerNode=function(){function ListenerNode(){this.previous=null;this.next=null;this.listener=null;this.once=false}return ListenerNode}();signals.ListenerNode=ListenerNode})(signals=artemis.signals||(artemis.signals={}))})(artemis||(artemis={}));var artemis;
(function(artemis){var signals;(function(signals){var ListenerNode=artemis.signals.ListenerNode;var ListenerNodePool=function(){function ListenerNodePool(){this.tail=null;this.cacheTail=null}ListenerNodePool.prototype.get=function(){var node;if(this.tail!==null){node=this.tail;this.tail=this.tail.previous;node.previous=null;return node}else return new ListenerNode};ListenerNodePool.prototype.dispose=function(node){node.listener=null;node.once=false;node.next=null;node.previous=this.tail;this.tail=
node};ListenerNodePool.prototype.cache=function(node){node.listener=null;node.previous=this.cacheTail;this.cacheTail=node};ListenerNodePool.prototype.releaseCache=function(){var node;while(this.cacheTail!==null){node=this.cacheTail;this.cacheTail=node.previous;node.next=null;node.previous=this.tail;this.tail=node}};return ListenerNodePool}();signals.ListenerNodePool=ListenerNodePool})(signals=artemis.signals||(artemis.signals={}))})(artemis||(artemis={}));var artemis;
(function(artemis){var signals;(function(signals){var ListenerNodePool=artemis.signals.ListenerNodePool;var SignalBase=function(){function SignalBase(){this.head=null;this.tail=null;this.numListeners=0;this.keys=null;this.nodes=null;this.listenerNodePool=null;this.toAddHead=null;this.toAddTail=null;this.dispatching=false;this.nodes=[];this.keys=[];this.listenerNodePool=new ListenerNodePool;this.numListeners=0}SignalBase.prototype.startDispatch=function(){this.dispatching=true};SignalBase.prototype.endDispatch=
function(){this.dispatching=false;if(this.toAddHead){if(!this.head){this.head=this.toAddHead;this.tail=this.toAddTail}else{this.tail.next=this.toAddHead;this.toAddHead.previous=this.tail;this.tail=this.toAddTail}this.toAddHead=null;this.toAddTail=null}this.listenerNodePool.releaseCache()};SignalBase.prototype.getNode=function(listener){var node;node=this.head;while(node!==null){if(node.listener===listener)break;node=node.next}if(node===null){node=this.toAddHead;while(node!==null){if(node.listener===
listener)break;node=node.next}}return node};SignalBase.prototype.add=function(listener){var node;if(this.keys.indexOf(listener)!==-1)return;node=this.listenerNodePool.get();node.listener=listener;this.nodes.push(node);this.keys.push(listener);this.addNode(node)};SignalBase.prototype.addOnce=function(listener){var node;if(this.keys.indexOf(listener)!==-1)return;node=this.listenerNodePool.get();node.listener=listener;node.once=true;this.nodes.push(node);this.keys.push(listener);this.addNode(node)};
SignalBase.prototype.addNode=function(node){if(this.dispatching)if(this.toAddHead===null)this.toAddHead=this.toAddTail=node;else{this.toAddTail.next=node;node.previous=this.toAddTail;this.toAddTail=node}else if(this.head===null)this.head=this.tail=node;else{this.tail.next=node;node.previous=this.tail;this.tail=node}this.numListeners++};SignalBase.prototype.remove=function(listener){var index,node;index=this.keys.indexOf(listener);node=this.nodes[index];if(node){if(this.head===node)this.head=this.head.next;
if(this.tail===node)this.tail=this.tail.previous;if(this.toAddHead===node)this.toAddHead=this.toAddHead.next;if(this.toAddTail===node)this.toAddTail=this.toAddTail.previous;if(node.previous)node.previous.next=node.next;if(node.next)node.next.previous=node.previous;this.nodes.splice(index,1);this.keys.splice(index,1);if(this.dispatching)this.listenerNodePool.cache(node);else this.listenerNodePool.dispose(node);this.numListeners--}};SignalBase.prototype.removeAll=function(){var index,node;while(this.head){node=
this.head;this.head=this.head.next;index=this.keys.indexOf(node.listener);this.nodes.splice(index,1);this.listenerNodePool.dispose(node)}this.nodes=[];this.keys=[];this.tail=null;this.toAddHead=null;this.toAddTail=null;this.numListeners=0};return SignalBase}();signals.SignalBase=SignalBase})(signals=artemis.signals||(artemis.signals={}))})(artemis||(artemis={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var signals;(function(signals){var Signal0=function(_super){__extends(Signal0,_super);function Signal0(){_super.apply(this,arguments)}Signal0.prototype.dispatch=function(){var node;this.startDispatch();node=this.head;while(node!==null){node.listener();if(node.once)this.remove(node.listener);node=node.next}return this.endDispatch()};return Signal0}(artemis.signals.SignalBase);signals.Signal0=Signal0})(signals=artemis.signals||(artemis.signals={}))})(artemis||(artemis={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var signals;(function(signals){var Signal1=function(_super){__extends(Signal1,_super);function Signal1(){_super.apply(this,arguments)}Signal1.prototype.dispatch=function($1){var node;this.startDispatch();node=this.head;while(node!==null){node.listener($1);if(node.once)this.remove(node.listener);node=node.next}return this.endDispatch()};return Signal1}(artemis.signals.SignalBase);signals.Signal1=Signal1})(signals=artemis.signals||(artemis.signals={}))})(artemis||(artemis={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var signals;(function(signals){var Signal2=function(_super){__extends(Signal2,_super);function Signal2(){_super.apply(this,arguments)}Signal2.prototype.dispatch=function($1,$2){var node;this.startDispatch();node=this.head;while(node){node.listener($1,$2);if(node.once)this.remove(node.listener);node=node.next}return this.endDispatch()};return Signal2}(artemis.signals.SignalBase);signals.Signal2=Signal2})(signals=artemis.signals||(artemis.signals={}))})(artemis||(artemis={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var signals;(function(signals){var Signal3=function(_super){__extends(Signal3,_super);function Signal3(){_super.apply(this,arguments)}Signal3.prototype.dispatch=function($1,$2,$3){var node;this.startDispatch();node=this.head;while(node!==null){node.listener($1,$2,$3);if(node.once)this.remove(node.listener);node=node.next}return this.endDispatch()};return Signal3}(artemis.signals.SignalBase);signals.Signal3=Signal3})(signals=artemis.signals||(artemis.signals={}))})(artemis||(artemis=
{}));var artemis;
(function(artemis){var utils;(function(utils){var Bag=function(){function Bag(capacity){if(capacity===void 0)capacity=64;this.size_=0;this.data_=new Array(capacity)}Bag.prototype.removeAt=function(index){var e=this.data_[index];this.data_[index]=this.data_[--this.size_];this.data_[this.size_]=null;return e};Bag.prototype.remove=function(e){var i;var e2;for(i=0;i<this.size_;i++){e2=this.data_[i];if(e==e2){this.data_[i]=this.data_[--this.size_];this.data_[this.size_]=null;return true}}return false};Bag.prototype.removeLast=
function(){if(this.size_>0){var e=this.data_[--this.size_];this.data_[this.size_]=null;return e}return null};Bag.prototype.contains=function(e){var i;for(i=0;this.size_>i;i++)if(e===this.data_[i])return true;return false};Bag.prototype.removeAll=function(bag){var modified=false;var i;var j;var e1;var e2;for(i=0;i<bag.size();i++){e1=bag.get(i);for(j=0;j<this.size_;j++){e2=this.data_[j];if(e1===e2){this.removeAt(j);j--;modified=true;break}}}return modified};Bag.prototype.get=function(index){if(index>=
this.data_.length)throw new Error("ArrayIndexOutOfBoundsException");return this.data_[index]};Bag.prototype.safeGet=function(index){if(index>=this.data_.length)this.grow(index*7/4+1);return this.data_[index]};Bag.prototype.size=function(){return this.size_};Bag.prototype.getCapacity=function(){return this.data_.length};Bag.prototype.isIndexWithinBounds=function(index){return index<this.getCapacity()};Bag.prototype.isEmpty=function(){return this.size_==0};Bag.prototype.add=function(e){if(this.size_===
this.data_.length)this.grow();this.data_[this.size_++]=e};Bag.prototype.set=function(index,e){if(index>=this.data_.length)this.grow(index*2);this.size_=index+1;this.data_[index]=e};Bag.prototype.grow=function(newCapacity){if(newCapacity===void 0)newCapacity=~~(this.data_.length*3/2)+1;this.data_.length=~~newCapacity};Bag.prototype.ensureCapacity=function(index){if(index>=this.data_.length)this.grow(index*2)};Bag.prototype.clear=function(){var i;for(i=0;i<this.size_;i++)this.data_[i]=null;this.size_=
0};Bag.prototype.addAll=function(items){var i;for(i=0;items.size()>i;i++)this.add(items.get(i))};return Bag}();utils.Bag=Bag})(utils=artemis.utils||(artemis.utils={}))})(artemis||(artemis={}));var artemis;
(function(artemis){var utils;(function(utils){var ADDRESS_BITS_PER_WORD=5;var BITS_PER_WORD=1<<ADDRESS_BITS_PER_WORD;var WORD_MASK=4294967295;function numberOfTrailingZeros(i){if(i==0)return 64;var x=i;var y;var n=63;y=x<<32;if(y!=0){n-=32;x=y}y=x<<16;if(y!=0){n-=16;x=y}y=x<<8;if(y!=0){n-=8;x=y}y=x<<4;if(y!=0){n-=4;x=y}y=x<<2;if(y!=0){n-=2;x=y}return n-(x<<1>>>63)}var BitSet=function(){function BitSet(nbits){if(nbits===void 0)nbits=0;if(nbits<0)throw RangeError("Negative Array Size: ["+nbits+"]");
else if(nbits===0)this.words_=[];else{var words=this.words_=new Array((nbits-1>>ADDRESS_BITS_PER_WORD)+1);for(var i=0,l=words.length;i<l;i++)words[i]=0}}BitSet.prototype.nextSetBit=function(fromIndex){var u=fromIndex>>ADDRESS_BITS_PER_WORD;var words=this.words_;var wordsInUse=words.length;var word=words[u]&WORD_MASK<<fromIndex;while(true){if(word!==0)return u*BITS_PER_WORD+numberOfTrailingZeros(word);if(++u===wordsInUse)return-1;word=words[u]}};BitSet.prototype.intersects=function(set){var words=
this.words_;var wordsInUse=words.length;for(var i=Math.min(wordsInUse,set.words_.length)-1;i>=0;i--)if((words[i]&set.words_[i])!=0)return true;return false};BitSet.prototype.isEmpty=function(){return this.words_.length===0};BitSet.prototype.set=function(bitIndex,value){if(value===void 0)value=true;var wordIndex=bitIndex>>ADDRESS_BITS_PER_WORD;var words=this.words_;var wordsInUse=words.length;var wordsRequired=wordIndex+1;if(wordsInUse<wordsRequired){words.length=Math.max(2*wordsInUse,wordsRequired);
for(var i=wordsInUse,l=words.length;i<l;i++)words[i]=0}if(value)return words[wordIndex]|=1<<bitIndex;else return words[wordIndex]&=~(1<<bitIndex)};BitSet.prototype.get=function(bitIndex){var wordIndex=bitIndex>>ADDRESS_BITS_PER_WORD;var words=this.words_;var wordsInUse=words.length;return wordIndex<wordsInUse&&(words[wordIndex]&1<<bitIndex)!=0};BitSet.prototype.clear=function(bitIndex){if(bitIndex===null){var words=this.words_;var wordsInUse=words.length;while(wordsInUse>0)words[--wordsInUse]=0;return}var wordIndex=
bitIndex>>ADDRESS_BITS_PER_WORD;this.words_[wordIndex]&=~(1<<bitIndex)};return BitSet}();utils.BitSet=BitSet})(utils=artemis.utils||(artemis.utils={}))})(artemis||(artemis={}));var artemis;
(function(artemis){var utils;(function(utils){var MathUtils=function(){function MathUtils(){}MathUtils.nextBool=function(){return(~~(Math.random()*32767)&1)===1};MathUtils.nextDouble=function(){return Math.random()};MathUtils.nextInt=function(max){return~~(Math.random()*max)};MathUtils.random=function(start,end){if(end===null)return MathUtils.nextInt(start+1);else if(parseInt(start)===parseFloat(start)&&parseInt(end)===parseFloat(end))return start+MathUtils.nextInt(end-start+1);else return start+
MathUtils.nextDouble()*(end-start)};return MathUtils}();utils.MathUtils=MathUtils})(utils=artemis.utils||(artemis.utils={}))})(artemis||(artemis={}));var artemis;
(function(artemis){var utils;(function(utils){function decode(key){switch(typeof key){case "boolean":return""+key;case "number":return""+key;case "string":return""+key;case "function":return artemis.getClassName(key);default:key.uuid=key.uuid?key.uuid:utils.UUID.randomUUID();return key.uuid}}var HashMap=function(){function HashMap(){this.clear()}HashMap.prototype.clear=function(){this.map_={};this.keys_={}};HashMap.prototype.values=function(){var result=[];for(var key in this.map_)result.push(this.map_[key]);
return result};HashMap.prototype.contains=function(value){for(var key in this.map_)if(value===this.map_[key])return true;return false};HashMap.prototype.containsKey=function(key){return decode(key)in this.map_};HashMap.prototype.containsValue=function(value){for(var key in this.map_)if(value===this.map_[key])return true;return false};HashMap.prototype.get=function(key){return this.map_[decode(key)]};HashMap.prototype.isEmpty=function(){return Object.keys(this.map_).length===0};HashMap.prototype.keys=
function(){var result=[];for(var key in this.keys_)result.push(this.keys_[key]);return result};HashMap.prototype.put=function(key,value){var k=decode(key);this.map_[k]=value;this.keys_[k]=key};HashMap.prototype.remove=function(key){var k=decode(key);var value=this.map_[k];delete this.map_[k];delete this.keys_[k];return value};HashMap.prototype.size=function(){return Object.keys(this.map_).length};return HashMap}();utils.HashMap=HashMap})(utils=artemis.utils||(artemis.utils={}))})(artemis||(artemis=
{}));var artemis;
(function(artemis){var utils;(function(utils){var Timer=function(){function Timer(delay,repeat){if(repeat===void 0)repeat=false;this.execute=function(){};this.delay=delay;this.repeat=repeat;this.acc=0}Timer.prototype.update=function(delta){if(!this.done&&!this.stopped){this.acc+=delta;if(this.acc>=this.delay){this.acc-=this.delay;if(this.repeat)this.reset();else this.done=true;this.execute()}}};Timer.prototype.reset=function(){this.stopped=false;this.done=false;this.acc=0};Timer.prototype.isDone=function(){return this.done};
Timer.prototype.isRunning=function(){return!this.done&&this.acc<this.delay&&!this.stopped};Timer.prototype.stop=function(){this.stopped=true};Timer.prototype.setDelay=function(delay){this.delay=delay};Timer.prototype.getPercentageRemaining=function(){if(this.done)return 100;else if(this.stopped)return 0;else return 1-(this.delay-this.acc)/this.delay};Timer.prototype.getDelay=function(){return this.delay};return Timer}();utils.Timer=Timer})(utils=artemis.utils||(artemis.utils={}))})(artemis||(artemis=
{}));var artemis;
(function(artemis){var utils;(function(utils){var TrigLUT=function(){function TrigLUT(){}TrigLUT.main=function(){console.log(TrigLUT.cos(Math.PI));console.log(TrigLUT.cosDeg(180))};TrigLUT.sin=function(rad){return TrigLUT.sin_[rad*TrigLUT.radToIndex&TrigLUT.SIN_MASK]};TrigLUT.cos=function(rad){return TrigLUT.cos_[rad*TrigLUT.radToIndex&TrigLUT.SIN_MASK]};TrigLUT.sinDeg=function(deg){return TrigLUT.sin_[deg*TrigLUT.degToIndex&TrigLUT.SIN_MASK]};TrigLUT.cosDeg=function(deg){return TrigLUT.cos_[deg*TrigLUT.degToIndex&
TrigLUT.SIN_MASK]};TrigLUT.init=function(update){TrigLUT.RAD=Math.PI/180;TrigLUT.DEG=180/Math.PI;TrigLUT.SIN_BITS=12;TrigLUT.SIN_MASK=~(-1<<TrigLUT.SIN_BITS);TrigLUT.SIN_COUNT=TrigLUT.SIN_MASK+1;TrigLUT.radFull=Math.PI*2;TrigLUT.degFull=360;TrigLUT.radToIndex=TrigLUT.SIN_COUNT/TrigLUT.radFull;TrigLUT.degToIndex=TrigLUT.SIN_COUNT/TrigLUT.degFull;TrigLUT.sin_=new Array(TrigLUT.SIN_COUNT);TrigLUT.cos_=new Array(TrigLUT.SIN_COUNT);for(var i=0;i<TrigLUT.SIN_COUNT;i++){TrigLUT.sin_[i]=Math.sin((i+.5)/TrigLUT.SIN_COUNT*
TrigLUT.radFull);TrigLUT.cos_[i]=Math.cos((i+.5)/TrigLUT.SIN_COUNT*TrigLUT.radFull)}if(update){Math.sin=TrigLUT.sin;Math.cos=TrigLUT.cos}};return TrigLUT}();utils.TrigLUT=TrigLUT})(utils=artemis.utils||(artemis.utils={}))})(artemis||(artemis={}));var artemis;
(function(artemis){var utils;(function(utils){var hex=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59",
"5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be",
"bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];var UUID=function(){function UUID(){}UUID.randomUUID=function(){var d0=Math.random()*4294967295|0;var d1=Math.random()*4294967295|0;var d2=Math.random()*4294967295|0;var d3=Math.random()*
4294967295|0;return hex[d0&255]+hex[d0>>8&255]+hex[d0>>16&255]+hex[d0>>24&255]+"-"+hex[d1&255]+hex[d1>>8&255]+"-"+hex[d1>>16&15|64]+hex[d1>>24&255]+"-"+hex[d2&63|128]+hex[d2>>8&255]+"-"+hex[d2>>16&255]+hex[d2>>24&255]+hex[d3&255]+hex[d3>>8&255]+hex[d3>>16&255]+hex[d3>>24&255]};return UUID}();utils.UUID=UUID})(utils=artemis.utils||(artemis.utils={}))})(artemis||(artemis={}));var artemis;
(function(artemis){var annotations;(function(annotations){function EntityTemplate(component){return function(target,propertyKey,descriptor){EntityTemplate["entityTemplates"]=EntityTemplate["entityTemplates"]||{};EntityTemplate["entityTemplates"][component]=target}}annotations.EntityTemplate=EntityTemplate})(annotations=artemis.annotations||(artemis.annotations={}))})(artemis||(artemis={}));var artemis;
(function(artemis){var annotations;(function(annotations){function Mapper(component){return function(target,propertyKey,descriptor){var klass=target.constructor;klass.declaredFields=klass.declaredFields||[];klass.declaredFields.push(propertyKey);klass.prototype[propertyKey]=component}}annotations.Mapper=Mapper})(annotations=artemis.annotations||(artemis.annotations={}))})(artemis||(artemis={}));var artemis;
(function(artemis){var annotations;(function(annotations){function Pooled(){return function(klass,propertyKey,descriptor){Pooled["pooledComponents"]=Pooled["pooledComponents"]||{};Pooled["pooledComponents"][artemis.getClassName(klass)]=klass}}annotations.Pooled=Pooled;Pooled["pooledComponents"]={}})(annotations=artemis.annotations||(artemis.annotations={}))})(artemis||(artemis={}));var artemis;
(function(artemis){var blackboard;(function(blackboard){(function(TriggerStateType){TriggerStateType[TriggerStateType["ValueAdded"]=1]="ValueAdded";TriggerStateType[TriggerStateType["ValueRemoved"]=16]="ValueRemoved";TriggerStateType[TriggerStateType["ValueChanged"]=256]="ValueChanged";TriggerStateType[TriggerStateType["TriggerAdded"]=4096]="TriggerAdded"})(blackboard.TriggerStateType||(blackboard.TriggerStateType={}));var TriggerStateType=blackboard.TriggerStateType})(blackboard=artemis.blackboard||
(artemis.blackboard={}))})(artemis||(artemis={}));var artemis;
(function(artemis){var blackboard;(function(blackboard){var BlackBoard=function(){function BlackBoard(){this.intelligence={};this.triggers={}}BlackBoard.prototype.addTrigger=function(trigger,evaluateNow){if(evaluateNow===void 0)evaluateNow=false;trigger.blackboard=this;for(var i in trigger.worldPropertiesMonitored){var intelName=trigger.worldPropertiesMonitored[i];if(this.triggers[name])this.triggers[name].push(trigger);else this.triggers[name]=[trigger]}if(evaluateNow)if(trigger.isFired===false)trigger.fire(blackboard.TriggerStateType.TriggerAdded)};
BlackBoard.prototype.atomicOperateOnEntry=function(operation){operation(this)};BlackBoard.prototype.getEntry=function(name){return this.intelligence[name]};BlackBoard.prototype.removeEntry=function(name){if(this.intelligence[name]){delete this.intelligence[name];if(this.triggers[name])for(var i in this.triggers[name]){var item=this.triggers[name][i];if(item.isFired===false)item.fire(blackboard.TriggerStateType.ValueRemoved)}}};BlackBoard.prototype.removeTrigger=function(trigger){for(var i in trigger.worldPropertiesMonitored){var intelName=
trigger.worldPropertiesMonitored[i];var t=this.triggers[intelName].indexOf(trigger);if(t!==-1)this.triggers[intelName].slice(t,1)}};BlackBoard.prototype.setEntry=function(name,intel){var triggerStateType=this.intelligence[name]?blackboard.TriggerStateType.ValueChanged:blackboard.TriggerStateType.ValueAdded;this.intelligence[name]=intel;if(this.triggers[name])for(var i in this.triggers[name]){var item=this.triggers[name][i];if(item.isFired===false)item.fire(triggerStateType)}};BlackBoard.prototype.triggerList=
function(name){return this.triggers[name]};return BlackBoard}();blackboard.BlackBoard=BlackBoard})(blackboard=artemis.blackboard||(artemis.blackboard={}))})(artemis||(artemis={}));var artemis;
(function(artemis){var blackboard;(function(blackboard){var Trigger=function(){function Trigger(propertyName){this.isFired=false;this.worldPropertiesMonitored=[].concat(propertyName)}Trigger.prototype.removeThisTrigger=function(){this.blackboard.removeTrigger(this)};Trigger.prototype.fire=function(triggerStateType){this.isFired=true;this.triggerStateType=triggerStateType;if(this.checkConditionToFire()){this.calledOnFire(triggerStateType);if(this.onFire!==null)this.onFire(this)}this.isFired=false};
Trigger.prototype.calledOnFire=function(triggerStateType){};Trigger.prototype.checkConditionToFire=function(){return true};return Trigger}();blackboard.Trigger=Trigger})(blackboard=artemis.blackboard||(artemis.blackboard={}))})(artemis||(artemis={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var blackboard;(function(blackboard){var SimpleTrigger=function(_super){__extends(SimpleTrigger,_super);function SimpleTrigger(name,condition,onFire){_super.call(this,[name]);this.condition=condition;this.onFire=onFire}SimpleTrigger.prototype.calledOnFire=function(triggerStateType){if(this.onFire!==null)this.onFire(triggerStateType)};SimpleTrigger.prototype.checkConditionToFire=function(){return this.condition(this.blackboard,this.triggerStateType)};return SimpleTrigger}(blackboard.Trigger);
blackboard.SimpleTrigger=SimpleTrigger})(blackboard=artemis.blackboard||(artemis.blackboard={}))})(artemis||(artemis={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var blackboard;(function(blackboard){var TriggerMultiCondition=function(_super){__extends(TriggerMultiCondition,_super);function TriggerMultiCondition(condition,onFire,names){_super.call(this,names);this.condition=condition;this.onFire=onFire}TriggerMultiCondition.prototype.removeThisTrigger=function(){this.blackboard.removeTrigger(this)};TriggerMultiCondition.prototype.calledOnFire=function(triggerStateType){if(this.onFire!==null)this.onFire(triggerStateType)};TriggerMultiCondition.prototype.checkConditionToFire=
function(){return this.condition(this.blackboard,this.triggerStateType)};return TriggerMultiCondition}(blackboard.Trigger);blackboard.TriggerMultiCondition=TriggerMultiCondition})(blackboard=artemis.blackboard||(artemis.blackboard={}))})(artemis||(artemis={}));var artemis;
(function(artemis){var Component=function(){function Component(){}Component.prototype.initialize=function(){var args=[];for(var _i=0;_i<arguments.length;_i++)args[_i-0]=arguments[_i]};return Component}();artemis.Component=Component})(artemis||(artemis={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var PooledComponent=function(_super){__extends(PooledComponent,_super);function PooledComponent(){_super.apply(this,arguments)}PooledComponent.prototype.reset=function(){};return PooledComponent}(artemis.Component);artemis.PooledComponent=PooledComponent})(artemis||(artemis={}));var artemis;
(function(artemis){var BitSet=artemis.utils.BitSet;var Aspect=function(){function Aspect(){this.allSet_=new BitSet;this.exclusionSet_=new BitSet;this.oneSet_=new BitSet}Aspect.prototype.setWorld=function(world){this.world_=world};Aspect.prototype.getAllSet=function(){return this.allSet_};Aspect.prototype.getExclusionSet=function(){return this.exclusionSet_};Aspect.prototype.getOneSet=function(){return this.oneSet_};Aspect.prototype.getIndexFor=function(c){return Aspect.typeFactory.getIndexFor(c)};
Aspect.prototype.all=function(type){var types=[];for(var _i=1;_i<arguments.length;_i++)types[_i-1]=arguments[_i];this.allSet_.set(this.getIndexFor(type));var t;for(t in types)this.allSet_.set(this.getIndexFor(types[t]));return this};Aspect.prototype.exclude=function(type){var types=[];for(var _i=1;_i<arguments.length;_i++)types[_i-1]=arguments[_i];this.exclusionSet_.set(this.getIndexFor(type));var t;for(t in types)this.exclusionSet_.set(this.getIndexFor(types[t]));return this};Aspect.prototype.one=
function(type){var types=[];for(var _i=1;_i<arguments.length;_i++)types[_i-1]=arguments[_i];this.oneSet_.set(this.getIndexFor(type));for(var t in types)this.oneSet_.set(this.getIndexFor(types[t]));return this};Aspect.getAspectFor=function(type){var types=[];for(var _i=1;_i<arguments.length;_i++)types[_i-1]=arguments[_i];return Aspect.getAspectForAll.apply(Aspect,[type].concat(types))};Aspect.getAspectForAll=function(type){var types=[];for(var _i=1;_i<arguments.length;_i++)types[_i-1]=arguments[_i];
var aspect=new Aspect;aspect.all.apply(aspect,[type].concat(types));return aspect};Aspect.getAspectForOne=function(type){var types=[];for(var _i=1;_i<arguments.length;_i++)types[_i-1]=arguments[_i];var aspect=new Aspect;aspect.one.apply(aspect,[type].concat(types));return aspect};Aspect.getEmpty=function(){return new Aspect};return Aspect}();artemis.Aspect=Aspect})(artemis||(artemis={}));var artemis;
(function(artemis){var BitSet=artemis.utils.BitSet;var UUID=artemis.utils.UUID;var Entity=function(){function Entity(world,id){this.world_=world;this.id_=id;this.entityManager_=world.getEntityManager();this.componentManager_=world.getComponentManager();this.systemBits_=new BitSet;this.componentBits_=new BitSet;this.reset()}Entity.prototype.getId=function(){return this.id_};Entity.prototype.getComponentBits=function(){return this.componentBits_};Entity.prototype.getSystemBits=function(){return this.systemBits_};
Entity.prototype.reset=function(){this.systemBits_.clear();this.componentBits_.clear();this.uuid=UUID.randomUUID()};Entity.prototype.toString=function(){return"Entity["+this.id_+"]"};Entity.prototype.createComponent=function(componentKlazz){var args=[];for(var _i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];var componentManager=this.world_.getComponentManager();var component=componentManager.create(this,componentKlazz);if(args.length)(_a=component).initialize.apply(_a,args);var tf=this.world_.getComponentManager().typeFactory;
var componentType=tf.getTypeFor(componentKlazz);this.componentBits_.set(componentType.getIndex());return component;var _a};Entity.prototype.addComponent=function(component){var args=[];for(var _i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];var type;if(component instanceof artemis.Component)type=args[0];else{component=this.createComponent.apply(this,[component].concat(args));type=this.getTypeFor(component.constructor)}if(type===undefined)type=this.getTypeFor(component.constructor);this.componentManager_.addComponent(this,
type,component);return this};Entity.prototype.getTypeFor=function(c){return this.world_.getComponentManager().typeFactory.getTypeFor(c)};Entity.prototype.removeComponentInstance=function(component){this.removeComponent(this.getTypeFor(component.constructor));return this};Entity.prototype.removeComponent=function(type){this.componentManager_.removeComponent(this,type);return this};Entity.prototype.removeComponentByType=function(type){this.removeComponent(this.getTypeFor(type));return this};Entity.prototype.isActive=
function(){return this.entityManager_.isActive(this.id_)};Entity.prototype.isEnabled=function(){return this.entityManager_.isEnabled(this.id_)};Entity.prototype.getComponent=function(type){return this.componentManager_.getComponent(this,type)};Entity.prototype.getComponentByType=function(type){return this.componentManager_.getComponent(this,this.getTypeFor(type))};Entity.prototype.getComponents=function(fillBag){return this.componentManager_.getComponentsFor(this,fillBag)};Entity.prototype.addToWorld=
function(){this.world_.addEntity(this)};Entity.prototype.changedInWorld=function(){this.world_.changedEntity(this)};Entity.prototype.deleteFromWorld=function(){this.world_.deleteEntity(this)};Entity.prototype.enable=function(){this.world_.enable(this)};Entity.prototype.disable=function(){this.world_.disable(this)};Entity.prototype.getUuid=function(){return this.uuid};Entity.prototype.getWorld=function(){return this.world_};return Entity}();artemis.Entity=Entity})(artemis||(artemis={}));var artemis;
(function(artemis){var Manager=function(){function Manager(){}Manager.prototype.initialize=function(){};Manager.prototype.setWorld=function(world){this.world_=world};Manager.prototype.getWorld=function(){return this.world_};Manager.prototype.added=function(e){};Manager.prototype.changed=function(e){};Manager.prototype.deleted=function(e){};Manager.prototype.disabled=function(e){};Manager.prototype.enabled=function(e){};return Manager}();artemis.Manager=Manager})(artemis||(artemis={}));var artemis;
(function(artemis){var Bag=artemis.utils.Bag;var HashMap=artemis.utils.HashMap;var EntityTemplate=artemis.annotations.EntityTemplate;var World=function(){function World(){this.managers_=new HashMap;this.managersBag_=new Bag;this.systems_=new HashMap;this.systemsBag_=new Bag;this.added_=new Bag;this.changed_=new Bag;this.deleted_=new Bag;this.enable_=new Bag;this.disable_=new Bag;this.cm_=new artemis.ComponentManager;this.setManager(this.cm_);this.em_=new artemis.EntityManager;this.setManager(this.em_)}
World.prototype.initialize=function(){for(var i=0;i<this.managersBag_.size();i++)this.managersBag_.get(i).initialize();for(var i=0;i<this.systemsBag_.size();i++){ComponentMapperInitHelper.config(this.systemsBag_.get(i),this);this.systemsBag_.get(i).initialize()}this.entityTemplates={};for(var component in EntityTemplate["entityTemplates"]){var Template=EntityTemplate["entityTemplates"][component];this.setEntityTemplate(component,new Template)}};World.prototype.getEntityManager=function(){return this.em_};
World.prototype.getComponentManager=function(){return this.cm_};World.prototype.setManager=function(manager){this.managers_.put(manager.constructor,manager);this.managersBag_.add(manager);manager.setWorld(this);return manager};World.prototype.getManager=function(managerType){return this.managers_.get(managerType)};World.prototype.deleteManager=function(manager){this.managers_.remove(manager);this.managersBag_.remove(manager)};World.prototype.getDelta=function(){return this.delta};World.prototype.setDelta=
function(delta){this.delta=delta};World.prototype.addEntity=function(e){this.added_.add(e)};World.prototype.changedEntity=function(e){this.changed_.add(e)};World.prototype.deleteEntity=function(e){if(!this.deleted_.contains(e))this.deleted_.add(e)};World.prototype.enable=function(e){this.enable_.add(e)};World.prototype.disable=function(e){this.disable_.add(e)};World.prototype.createEntity=function(){return this.em_.createEntityInstance()};World.prototype.getEntity=function(entityId){return this.em_.getEntity(entityId)};
World.prototype.getSystems=function(){return this.systemsBag_};World.prototype.setSystem=function(system,passive){if(passive===void 0)passive=false;system.setWorld(this);system.setPassive(passive);this.systems_.put(system.constructor,system);this.systemsBag_.add(system);return system};World.prototype.deleteSystem=function(system){this.systems_.remove(system.constructor);this.systemsBag_.remove(system)};World.prototype.notifySystems=function(performer,e){for(var i=0,s=this.systemsBag_.size();s>i;i++)performer.perform(this.systemsBag_.get(i),
e)};World.prototype.notifyManagers=function(performer,e){for(var a=0;this.managersBag_.size()>a;a++)performer.perform(this.managersBag_.get(a),e)};World.prototype.getSystem=function(type){return this.systems_.get(type)};World.prototype.check=function(entities,performer){if(!entities.isEmpty()){for(var i=0;entities.size()>i;i++){var e=entities.get(i);this.notifyManagers(performer,e);this.notifySystems(performer,e)}entities.clear()}};World.prototype.process=function(){this.check(this.added_,{perform:function(observer,
e){observer.added(e)}});this.check(this.changed_,{perform:function(observer,e){observer.changed(e)}});this.check(this.disable_,{perform:function(observer,e){observer.disabled(e)}});this.check(this.enable_,{perform:function(observer,e){observer.enabled(e)}});this.check(this.deleted_,{perform:function(observer,e){observer.deleted(e)}});this.cm_.clean();for(var i=0;this.systemsBag_.size()>i;i++){var system=this.systemsBag_.get(i);if(!system.isPassive())system.process()}};World.prototype.getMapper=function(type){return artemis.ComponentMapper.getFor(type,
this)};World.prototype.setEntityTemplate=function(entityTag,entityTemplate){this.entityTemplates[entityTag]=entityTemplate};World.prototype.createEntityFromTemplate=function(name){var args=[];for(var _i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];return(_a=this.entityTemplates[name]).buildEntity.apply(_a,[this.createEntity(),this].concat(args));var _a};return World}();artemis.World=World;var ComponentMapperInitHelper=function(){function ComponentMapperInitHelper(){}ComponentMapperInitHelper.config=
function(target,world){try{var clazz=target.constructor;for(var fieldIndex in clazz.declaredFields){var field=clazz.declaredFields[fieldIndex];if(!target.hasOwnProperty(field)){var componentType=clazz.prototype[field];target[field]=world.getMapper(componentType)}}}catch(e){throw new Error("Error while setting component mappers");}};return ComponentMapperInitHelper}()})(artemis||(artemis={}));var artemis;
(function(artemis){var Bag=artemis.utils.Bag;var ComponentPool=function(){function ComponentPool(){this.pools=new Bag}ComponentPool.prototype.obtain=function(componentClass,type){var pool=this.getPool(type.getIndex());return pool.size()>0?pool.obtain():new componentClass};ComponentPool.prototype.free=function(c,type){this.freeByIndex(c,type.getIndex())};ComponentPool.prototype.freeByIndex=function(c,typeIndex){c.reset();this.getPool(typeIndex).free(c)};ComponentPool.prototype.getPool=function(typeIndex){var pool=
this.pools.safeGet(typeIndex);if(pool==null){pool=new Pool;this.pools.set(typeIndex,pool)}return pool};return ComponentPool}();artemis.ComponentPool=ComponentPool;var Pool=function(){function Pool(){this.cache=new Bag}Pool.prototype.obtain=function(){return this.cache.removeLast()};Pool.prototype.size=function(){return this.cache.size()};Pool.prototype.free=function(component){this.cache.add(component)};return Pool}()})(artemis||(artemis={}));var artemis;
(function(artemis){var Pooled=artemis.annotations.Pooled;(function(Taxonomy){Taxonomy[Taxonomy["BASIC"]=0]="BASIC";Taxonomy[Taxonomy["POOLED"]=1]="POOLED"})(artemis.Taxonomy||(artemis.Taxonomy={}));var Taxonomy=artemis.Taxonomy;var ComponentType=function(){function ComponentType(type,index){this.index_=0;if(index!==undefined)this.index_=ComponentType.INDEX++;else this.index_=index;this.type_=type;if(Pooled["pooledComponents"][artemis.getClassName(type)]===type)this.taxonomy_=Taxonomy.POOLED;else this.taxonomy_=
Taxonomy.BASIC}ComponentType.prototype.getName=function(){return artemis.getClassName(this.type_)};ComponentType.prototype.getIndex=function(){return this.index_};ComponentType.prototype.getTaxonomy=function(){return this.taxonomy_};ComponentType.prototype.toString=function(){return"ComponentType["+artemis.getClassName(ComponentType)+"] ("+this.index_+")"};ComponentType.INDEX=0;return ComponentType}();artemis.ComponentType=ComponentType})(artemis||(artemis={}));var artemis;
(function(artemis){var Bag=artemis.utils.Bag;var ComponentType=artemis.ComponentType;var Aspect=artemis.Aspect;var ComponentTypeFactory=function(){function ComponentTypeFactory(){this.componentTypeCount_=0;this.componentTypes_={};this.types=new Bag;Aspect.typeFactory=this}ComponentTypeFactory.prototype.getTypeFor=function(c){if("number"===typeof c)return this.types.get(parseInt(c));var type=this.componentTypes_[artemis.getClassName(c)];if(type==null){var index=this.componentTypeCount_++;type=new ComponentType(c,
index);this.componentTypes_[artemis.getClassName(c)]=type;this.types.set(index,type)}return type};ComponentTypeFactory.prototype.getIndexFor=function(c){return this.getTypeFor(c).getIndex()};ComponentTypeFactory.prototype.getTaxonomy=function(index){return this.types.get(index).getTaxonomy()};return ComponentTypeFactory}();artemis.ComponentTypeFactory=ComponentTypeFactory})(artemis||(artemis={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var Bag=artemis.utils.Bag;var Manager=artemis.Manager;var ComponentTypeFactory=artemis.ComponentTypeFactory;var ComponentPool=artemis.ComponentPool;var Taxonomy=artemis.Taxonomy;var ComponentManager=function(_super){__extends(ComponentManager,_super);function ComponentManager(){_super.call(this);this.componentsByType_=new Bag;this.pooledComponents_=new ComponentPool;this.deleted_=new Bag;this.typeFactory=new ComponentTypeFactory}ComponentManager.prototype.initialize=function(){};
ComponentManager.prototype.create=function(owner,componentClass){var type=this.typeFactory.getTypeFor(componentClass);var component=null;switch(type.getTaxonomy()){case Taxonomy.BASIC:component=this.newInstance(componentClass,false);break;case Taxonomy.POOLED:this.reclaimPooled(owner,type);component=this.pooledComponents_.obtain(componentClass,type);break;default:throw new Error("InvalidComponentException unknown component type:"+type.getTaxonomy());}this.addComponent(owner,type,component);return component};
ComponentManager.prototype.reclaimPooled=function(owner,type){var components=this.componentsByType_.safeGet(type.getIndex());if(components==null)return;var old=components.safeGet(owner.getId());if(old!==undefined&&old!==null)this.pooledComponents_.free(old,type)};ComponentManager.prototype.newInstance=function(constructor,constructorHasWorldParameter){if(constructorHasWorldParameter)return new constructor(this.world_);else return new constructor};ComponentManager.prototype.removeComponentsOfEntity=
function(e){var componentBits=e.getComponentBits();for(var i=componentBits.nextSetBit(0);i>=0;i=componentBits.nextSetBit(i+1))switch(this.typeFactory.getTaxonomy(i)){case Taxonomy.BASIC:this.componentsByType_.get(i).set(e.getId(),null);break;case Taxonomy.POOLED:var pooled=this.componentsByType_.get(i).get(e.getId());this.pooledComponents_.freeByIndex(pooled,i);this.componentsByType_.get(i).set(e.getId(),null);break;default:throw new Error("InvalidComponentException"+" unknown component type: "+this.typeFactory.getTaxonomy(i));
}componentBits.clear()};ComponentManager.prototype.addComponent=function(e,type,component){this.componentsByType_.ensureCapacity(type.getIndex());var components=this.componentsByType_.get(type.getIndex());if(components==null){components=new Bag;this.componentsByType_.set(type.getIndex(),components)}components.set(e.getId(),component);e.getComponentBits().set(type.getIndex())};ComponentManager.prototype.removeComponent=function(e,type){var index=type.getIndex();switch(type.getTaxonomy()){case Taxonomy.BASIC:this.componentsByType_.get(index).set(e.getId(),
null);e.getComponentBits().clear(type.getIndex());break;case Taxonomy.POOLED:var pooled=this.componentsByType_.get(index).get(e.getId());e.getComponentBits().clear(type.getIndex());this.pooledComponents_.free(pooled,type);this.componentsByType_.get(index).set(e.getId(),null);break;default:throw new Error("InvalidComponentException"+type+" unknown component type: "+type.getTaxonomy());}};ComponentManager.prototype.getComponentsByType=function(type){var components=this.componentsByType_.get(type.getIndex());
if(components==null){components=new Bag;this.componentsByType_.set(type.getIndex(),components)}return components};ComponentManager.prototype.getComponent=function(e,type){var components=this.componentsByType_.get(type.getIndex());if(components!=null)return components.get(e.getId());return null};ComponentManager.prototype.getComponentsFor=function(e,fillBag){var componentBits=e.getComponentBits();for(var i=componentBits.nextSetBit(0);i>=0;i=componentBits.nextSetBit(i+1))fillBag.add(this.componentsByType_.get(i).get(e.getId()));
return fillBag};ComponentManager.prototype.deleted=function(e){this.deleted_.add(e)};ComponentManager.prototype.clean=function(){if(this.deleted_.size()>0){for(var i=0;this.deleted_.size()>i;i++)this.removeComponentsOfEntity(this.deleted_.get(i));this.deleted_.clear()}};return ComponentManager}(Manager);artemis.ComponentManager=ComponentManager})(artemis||(artemis={}));var artemis;
(function(artemis){var ComponentMapper=function(){function ComponentMapper(type,world){this.type_=world.getComponentManager().typeFactory.getTypeFor(type);this.components_=world.getComponentManager().getComponentsByType(this.type_);this.classType_=type}ComponentMapper.prototype.get=function(e){return this.components_.get(e.getId())};ComponentMapper.prototype.getSafe=function(e){if(this.components_.isIndexWithinBounds(e.getId()))return this.components_.get(e.getId());return null};ComponentMapper.prototype.has=
function(e){return this.getSafe(e)!=null};ComponentMapper.getFor=function(type,world){return new ComponentMapper(type,world)};return ComponentMapper}();artemis.ComponentMapper=ComponentMapper})(artemis||(artemis={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var Bag=artemis.utils.Bag;var BitSet=artemis.utils.BitSet;var Manager=artemis.Manager;var EntityManager=function(_super){__extends(EntityManager,_super);function EntityManager(){_super.call(this);this.entities_=new Bag;this.disabled_=new BitSet;this.identifierPool_=new IdentifierPool;this.active_=0;this.added_=0;this.created_=0;this.deleted_=0}EntityManager.prototype.initialize=function(){};EntityManager.prototype.createEntityInstance=function(){var e=new artemis.Entity(this.world_,
this.identifierPool_.checkOut());this.created_++;return e};EntityManager.prototype.added=function(e){this.active_++;this.added_++;this.entities_.set(e.getId(),e)};EntityManager.prototype.enabled=function(e){this.disabled_.clear(e.getId())};EntityManager.prototype.disabled=function(e){this.disabled_.set(e.getId())};EntityManager.prototype.deleted=function(e){this.entities_.set(e.getId(),null);this.disabled_.clear(e.getId());this.identifierPool_.checkIn(e.getId());this.active_--;this.deleted_++};EntityManager.prototype.isActive=
function(entityId){return this.entities_.get(entityId)!=null};EntityManager.prototype.isEnabled=function(entityId){return!this.disabled_.get(entityId)};EntityManager.prototype.getEntity=function(entityId){return this.entities_.get(entityId)};EntityManager.prototype.getActiveEntityCount=function(){return this.active_};EntityManager.prototype.getTotalCreated=function(){return this.created_};EntityManager.prototype.getTotalAdded=function(){return this.added_};EntityManager.prototype.getTotalDeleted=
function(){return this.deleted_};return EntityManager}(Manager);artemis.EntityManager=EntityManager;var IdentifierPool=function(){function IdentifierPool(){this.nextAvailableId_=0;this.ids_=new Bag}IdentifierPool.prototype.checkOut=function(){if(this.ids_.size()>0)return this.ids_.removeLast();return this.nextAvailableId_++};IdentifierPool.prototype.checkIn=function(id){this.ids_.add(id)};return IdentifierPool}()})(artemis||(artemis={}));var artemis;
(function(artemis){var Bag=artemis.utils.Bag;var HashMap=artemis.utils.HashMap;var BlackBoard=artemis.blackboard.BlackBoard;var EntitySystem=function(){function EntitySystem(aspect){this.actives_=new Bag;this.aspect_=aspect;this.systemIndex_=SystemIndexManager.getIndexFor(this.constructor);this.allSet_=aspect.getAllSet();this.exclusionSet_=aspect.getExclusionSet();this.oneSet_=aspect.getOneSet();this.dummy_=this.allSet_.isEmpty()&&this.oneSet_.isEmpty()}EntitySystem.prototype.begin=function(){};EntitySystem.prototype.process=
function(){if(this.checkProcessing()){this.begin();this.processEntities(this.actives_);this.end()}};EntitySystem.prototype.end=function(){};EntitySystem.prototype.processEntities=function(entities){};EntitySystem.prototype.checkProcessing=function(){return true};EntitySystem.prototype.initialize=function(){};EntitySystem.prototype.inserted=function(e){};EntitySystem.prototype.removed=function(e){};EntitySystem.prototype.check=function(e){if(this.dummy_)return;var contains=e.getSystemBits().get(this.systemIndex_);
var interested=true;var componentBits=e.getComponentBits();if(!this.allSet_.isEmpty())for(var i=this.allSet_.nextSetBit(0);i>=0;i=this.allSet_.nextSetBit(i+1))if(!componentBits.get(i)){interested=false;break}if(!this.exclusionSet_.isEmpty()&&interested)interested=!this.exclusionSet_.intersects(componentBits);if(!this.oneSet_.isEmpty())interested=this.oneSet_.intersects(componentBits);if(interested&&!contains)this.insertToSystem(e);else if(!interested&&contains)this.removeFromSystem(e)};EntitySystem.prototype.removeFromSystem=
function(e){this.actives_.remove(e);e.getSystemBits().clear(this.systemIndex_);this.removed(e)};EntitySystem.prototype.insertToSystem=function(e){this.actives_.add(e);e.getSystemBits().set(this.systemIndex_);this.inserted(e)};EntitySystem.prototype.added=function(e){this.check(e)};EntitySystem.prototype.changed=function(e){this.check(e)};EntitySystem.prototype.deleted=function(e){if(e.getSystemBits().get(this.systemIndex_))this.removeFromSystem(e)};EntitySystem.prototype.disabled=function(e){if(e.getSystemBits().get(this.systemIndex_))this.removeFromSystem(e)};
EntitySystem.prototype.enabled=function(e){this.check(e)};EntitySystem.prototype.setWorld=function(world){this.world=world};EntitySystem.prototype.isPassive=function(){return this.passive_};EntitySystem.prototype.setPassive=function(passive){this.passive_=passive};EntitySystem.prototype.getActive=function(){return this.actives_};EntitySystem.blackBoard=new BlackBoard;return EntitySystem}();artemis.EntitySystem=EntitySystem;var SystemIndexManager=function(){function SystemIndexManager(){}SystemIndexManager.getIndexFor=
function(es){var index=SystemIndexManager.indices.get(es);if(index===undefined){index=SystemIndexManager.INDEX++;SystemIndexManager.indices.put(es,index)}return index};SystemIndexManager.INDEX=0;SystemIndexManager.indices=new HashMap;return SystemIndexManager}()})(artemis||(artemis={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var managers;(function(managers){var Bag=artemis.utils.Bag;var HashMap=artemis.utils.HashMap;var Manager=artemis.Manager;var GroupManager=function(_super){__extends(GroupManager,_super);function GroupManager(){_super.call(this);this.entitiesByGroup_=new HashMap;this.groupsByEntity_=new HashMap}GroupManager.prototype.initialize=function(){};GroupManager.prototype.add=function(e,group){var entities=this.entitiesByGroup_.get(group);if(entities==null){entities=new Bag;this.entitiesByGroup_.put(group,
entities)}entities.add(e);var groups=this.groupsByEntity_.get(e);if(groups==null){groups=new Bag;this.groupsByEntity_.put(e,groups)}groups.add(group)};GroupManager.prototype.remove=function(e,group){var entities=this.entitiesByGroup_.get(group);if(entities!=null)entities.remove(e);var groups=this.groupsByEntity_.get(e);if(groups!=null)groups.remove(group)};GroupManager.prototype.removeFromAllGroups=function(e){var groups=this.groupsByEntity_.get(e);if(groups!=null){for(var i=0;groups.size()>i;i++){var entities=
this.entitiesByGroup_.get(groups.get(i));if(entities!=null)entities.remove(e)}groups.clear()}};GroupManager.prototype.getEntities=function(group){var entities=this.entitiesByGroup_.get(group);if(entities==null){entities=new Bag;this.entitiesByGroup_.put(group,entities)}return entities};GroupManager.prototype.getGroups=function(e){return this.groupsByEntity_.get(e)};GroupManager.prototype.isInAnyGroup=function(e){return this.getGroups(e)!=null};GroupManager.prototype.isInGroup=function(e,group){if(group!=
null){var groups=this.groupsByEntity_.get(e);for(var i=0;groups.size()>i;i++){var g=groups.get(i);if(group===g)return true}}return false};GroupManager.prototype.deleted=function(e){this.removeFromAllGroups(e)};return GroupManager}(Manager);managers.GroupManager=GroupManager})(managers=artemis.managers||(artemis.managers={}))})(artemis||(artemis={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var managers;(function(managers){var Bag=artemis.utils.Bag;var HashMap=artemis.utils.HashMap;var Manager=artemis.Manager;var PlayerManager=function(_super){__extends(PlayerManager,_super);function PlayerManager(){_super.call(this);this.playerByEntity_=new HashMap;this.entitiesByPlayer_=new HashMap}PlayerManager.prototype.setPlayer=function(e,player){this.playerByEntity_.put(e,player);var entities=this.entitiesByPlayer_.get(player);if(entities==null){entities=new Bag;this.entitiesByPlayer_.put(player,
entities)}entities.add(e)};PlayerManager.prototype.getEntitiesOfPlayer=function(player){var entities=this.entitiesByPlayer_.get(player);if(entities==null)entities=new Bag;return entities};PlayerManager.prototype.removeFromPlayer=function(e){var player=this.playerByEntity_.get(e);if(player!==null){var entities=this.entitiesByPlayer_.get(player);if(entities!==null)entities.remove(e)}};PlayerManager.prototype.getPlayer=function(e){return this.playerByEntity_.get(e)};PlayerManager.prototype.initialize=
function(){};PlayerManager.prototype.deleted=function(e){this.removeFromPlayer(e)};return PlayerManager}(Manager);managers.PlayerManager=PlayerManager})(managers=artemis.managers||(artemis.managers={}))})(artemis||(artemis={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var managers;(function(managers){var HashMap=artemis.utils.HashMap;var Manager=artemis.Manager;var TagManager=function(_super){__extends(TagManager,_super);function TagManager(){_super.call(this);this.entitiesByTag_=new HashMap;this.tagsByEntity_=new HashMap}TagManager.prototype.register=function(tag,e){this.entitiesByTag_.put(tag,e);this.tagsByEntity_.put(e,tag)};TagManager.prototype.unregister=function(tag){this.tagsByEntity_.remove(this.entitiesByTag_.remove(tag))};TagManager.prototype.isRegistered=
function(tag){return this.entitiesByTag_.containsKey(tag)};TagManager.prototype.getEntity=function(tag){return this.entitiesByTag_.get(tag)};TagManager.prototype.getRegisteredTags=function(){return this.tagsByEntity_.values()};TagManager.prototype.deleted=function(e){var removedTag=this.tagsByEntity_.remove(e);if(removedTag!=null)this.entitiesByTag_.remove(removedTag)};TagManager.prototype.initialize=function(){};return TagManager}(Manager);managers.TagManager=TagManager})(managers=artemis.managers||
(artemis.managers={}))})(artemis||(artemis={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var managers;(function(managers){var Bag=artemis.utils.Bag;var HashMap=artemis.utils.HashMap;var Manager=artemis.Manager;var TeamManager=function(_super){__extends(TeamManager,_super);function TeamManager(){_super.call(this);this.playersByTeam_=new HashMap;this.teamByPlayer_=new HashMap}TeamManager.prototype.initialize=function(){};TeamManager.prototype.getTeam=function(player){return this.teamByPlayer_.get(player)};TeamManager.prototype.setTeam=function(player,team){this.removeFromTeam(player);
this.teamByPlayer_.put(player,team);var players=this.playersByTeam_.get(team);if(players==null){players=new Bag;this.playersByTeam_.put(team,players)}players.add(player)};TeamManager.prototype.getPlayers=function(team){return this.playersByTeam_.get(team)};TeamManager.prototype.removeFromTeam=function(player){var team=this.teamByPlayer_.remove(player);if(team!=null){var players=this.playersByTeam_.get(team);if(players!=null)players.remove(player)}};return TeamManager}(Manager);managers.TeamManager=
TeamManager})(managers=artemis.managers||(artemis.managers={}))})(artemis||(artemis={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var systems;(function(systems){var EntitySystem=artemis.EntitySystem;var DelayedEntityProcessingSystem=function(_super){__extends(DelayedEntityProcessingSystem,_super);function DelayedEntityProcessingSystem(aspect){_super.call(this,aspect)}DelayedEntityProcessingSystem.prototype.processEntities=function(entities){for(var i=0,s=entities.size();s>i;i++){var entity=entities.get(i);this.processDelta(entity,this.acc_);var remaining=this.getRemainingDelay(entity);if(remaining<=0)this.processExpired(entity);
else this.offerDelay(remaining)}this.stop()};DelayedEntityProcessingSystem.prototype.inserted=function(e){var delay=this.getRemainingDelay(e);if(delay>0)this.offerDelay(delay)};DelayedEntityProcessingSystem.prototype.getRemainingDelay=function(e){throw Error("Abstract Method");};DelayedEntityProcessingSystem.prototype.checkProcessing=function(){if(this.running_){this.acc_+=this.world.getDelta();if(this.acc_>=this.delay_)return true}return false};DelayedEntityProcessingSystem.prototype.processDelta=
function(e,accumulatedDelta){};DelayedEntityProcessingSystem.prototype.processExpired=function(e){};DelayedEntityProcessingSystem.prototype.restart=function(delay){this.delay_=delay;this.acc_=0;this.running_=true};DelayedEntityProcessingSystem.prototype.offerDelay=function(delay){if(!this.running_||delay<this.getRemainingTimeUntilProcessing())this.restart(delay)};DelayedEntityProcessingSystem.prototype.getInitialTimeDelay=function(){return this.delay_};DelayedEntityProcessingSystem.prototype.getRemainingTimeUntilProcessing=
function(){if(this.running_)return this.delay_-this.acc_;return 0};DelayedEntityProcessingSystem.prototype.isRunning=function(){return this.running_};DelayedEntityProcessingSystem.prototype.stop=function(){this.running_=false;this.acc_=0};return DelayedEntityProcessingSystem}(EntitySystem);systems.DelayedEntityProcessingSystem=DelayedEntityProcessingSystem})(systems=artemis.systems||(artemis.systems={}))})(artemis||(artemis={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var systems;(function(systems){var EntitySystem=artemis.EntitySystem;var EntityProcessingSystem=function(_super){__extends(EntityProcessingSystem,_super);function EntityProcessingSystem(aspect){_super.call(this,aspect)}EntityProcessingSystem.prototype.processEach=function(e){};EntityProcessingSystem.prototype.processEntities=function(entities){for(var i=0,s=entities.size();s>i;i++)this.processEach(entities.get(i))};EntityProcessingSystem.prototype.checkProcessing=function(){return true};
return EntityProcessingSystem}(EntitySystem);systems.EntityProcessingSystem=EntityProcessingSystem})(systems=artemis.systems||(artemis.systems={}))})(artemis||(artemis={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var systems;(function(systems){var EntitySystem=artemis.EntitySystem;var IntervalEntitySystem=function(_super){__extends(IntervalEntitySystem,_super);function IntervalEntitySystem(aspect,interval){_super.call(this,aspect);this.acc_=0;this.interval_=0;this.interval_=interval}IntervalEntitySystem.prototype.checkProcessing=function(){this.acc_+=this.world.getDelta();if(this.acc_>=this.interval_){this.acc_-=this.interval_;return true}return false};return IntervalEntitySystem}(EntitySystem);
systems.IntervalEntitySystem=IntervalEntitySystem})(systems=artemis.systems||(artemis.systems={}))})(artemis||(artemis={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var systems;(function(systems){var EntitySystem=artemis.EntitySystem;var Aspect=artemis.Aspect;var VoidEntitySystem=function(_super){__extends(VoidEntitySystem,_super);function VoidEntitySystem(){_super.call(this,Aspect.getEmpty())}VoidEntitySystem.prototype.processEntities=function(entities){this.processSystem()};VoidEntitySystem.prototype.processSystem=function(){};VoidEntitySystem.prototype.checkProcessing=function(){return true};return VoidEntitySystem}(EntitySystem);systems.VoidEntitySystem=
VoidEntitySystem})(systems=artemis.systems||(artemis.systems={}))})(artemis||(artemis={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var systems;(function(systems){var IntervalEntitySystem=artemis.systems.IntervalEntitySystem;var IntervalEntityProcessingSystem=function(_super){__extends(IntervalEntityProcessingSystem,_super);function IntervalEntityProcessingSystem(aspect,interval){_super.call(this,aspect,interval)}IntervalEntityProcessingSystem.prototype.processEach=function(e){};IntervalEntityProcessingSystem.prototype.processEntities=function(entities){for(var i=0,s=entities.size();s>i;i++)this.processEach(entities.get(i))};
return IntervalEntityProcessingSystem}(IntervalEntitySystem);systems.IntervalEntityProcessingSystem=IntervalEntityProcessingSystem})(systems=artemis.systems||(artemis.systems={}))})(artemis||(artemis={}));var asteroids;
(function(asteroids){var Constants=function(){function Constants(){}Constants.FRAME_WIDTH=800;Constants.FRAME_HEIGHT=450;Constants.Tags={START:"start",GAME:"game",SPACESHIP:"spaceship"};Constants.Groups={BULLETS:"bullets",ASTEROIDS:"asteroids",SPACESHIP:"spaceship"};return Constants}();asteroids.Constants=Constants})(asteroids||(asteroids={}));var asteroids;
(function(asteroids){var ui;(function(ui){var KeyPoll=function(){function KeyPoll(displayObj){var _this=this;this.states=null;this.keyDownListener=function(event){_this.states[event.keyCode]=true};this.keyUpListener=function(event){if(_this.states[event.keyCode])_this.states[event.keyCode]=false};this.isDown=function(keyCode){return _this.states[keyCode]};this.isUp=function(keyCode){return!_this.states[keyCode]};this.states={};displayObj.addEventListener("keydown",this.keyDownListener);displayObj.addEventListener("keyup",
this.keyUpListener)}return KeyPoll}();ui.KeyPoll=KeyPoll})(ui=asteroids.ui||(asteroids.ui={}))})(asteroids||(asteroids={}));var asteroids;
(function(asteroids){var ui;(function(ui){var Point=function(){function Point(x,y){if(x===void 0)x=0;if(y===void 0)y=0;this.x=0;this.y=0;this.x=x;this.y=y}Point.distance=function(point1,point2){var dx,dy;dx=point1.x-point2.x;dy=point1.y-point2.y;return Math.sqrt(dx*dx+dy*dy)};Point.prototype.distanceSquaredTo=function(targetPoint){var dx,dy;dx=this.x-targetPoint.x;dy=this.y-targetPoint.y;return dx*dx+dy*dy};Point.prototype.distanceTo=function(targetPoint){var dx,dy;dx=this.x-targetPoint.x;dy=this.y-
targetPoint.y;return Math.sqrt(dx*dx+dy*dy)};return Point}();ui.Point=Point})(ui=asteroids.ui||(asteroids.ui={}))})(asteroids||(asteroids={}));var asteroids;
(function(asteroids){var graphics;(function(graphics){var Tau=Math.PI*2;var Point=asteroids.ui.Point;var AsteroidDeathView=function(){function AsteroidDeathView(graphic,radius){this.dots=null;this.x=0;this.y=0;this.width=0;this.height=0;this.rotation=0;this.graphic=null;this.radius=0;this.points=null;this.count=0;this.first=true;this.graphic=graphic;this.radius=radius;this.dots=[]}AsteroidDeathView.prototype.animate=function(time){var dot;if(this.first){this.first=false;for(var i=0;i<AsteroidDeathView.numDots;i++){dot=
new Dot(this.graphic,this.radius,this.rotation);this.dots.push(dot)}}this.dots.forEach(function(dot){dot.x+=dot.velocity.x*time;return dot.y+=dot.velocity.y*time});return this.draw(this.graphic)};AsteroidDeathView.prototype.draw=function(graphic){var _this=this;this.dots.map(function(dot){dot.draw(graphic,_this.x,_this.y)})};AsteroidDeathView.numDots=8;return AsteroidDeathView}();graphics.AsteroidDeathView=AsteroidDeathView;var Dot=function(){function Dot(graphic,maxDistance,rotation){this.velocity=
null;this.graphic=null;this.rotation=0;this.x1=0;this.y1=0;this.x=0;this.y=0;this.graphic=graphic;this.rotation=rotation;var angle=Math.random()*Tau;var distance=Math.random()*maxDistance;this.x=Math.cos(angle)*distance;this.y=Math.sin(angle)*distance;var speed=Math.random()*10+10;this.velocity=new Point(Math.cos(angle)*speed,Math.sin(angle)*speed)}Dot.prototype.draw=function(graphic,x,y){graphic.save();graphic.beginPath();graphic.translate(~~x,~~y);graphic.rotate(this.rotation);graphic.fillStyle=
"#FFFFFF";graphic.arc(this.x,this.y,2,0,Tau,false);graphic.fill();graphic.restore()};return Dot}()})(graphics=asteroids.graphics||(asteroids.graphics={}))})(asteroids||(asteroids={}));var asteroids;
(function(asteroids){var graphics;(function(graphics){var Tau=Math.PI*2;var Point=asteroids.ui.Point;var AsteroidView=function(){function AsteroidView(graphic,radius){this.x=0;this.y=0;this.width=0;this.height=0;this.rotation=0;this.graphic=null;this.radius=0;this.points=null;this.count=0;var angle,length,posX,posY;this.graphic=graphic;this.radius=radius;this.width=this.radius;this.height=this.radius;this.points=[];angle=0;while(angle<Tau){length=(.75+Math.random()*.25)*this.radius;posX=~~(Math.cos(angle)*
length+.5);posY=~~(Math.sin(angle)*length+.5);this.points.push(new Point(posX,posY));angle+=Math.random()*.5}}AsteroidView.prototype.draw=function(graphic){graphic.save();graphic.beginPath();graphic.translate(this.x,this.y);graphic.rotate(this.rotation);graphic.fillStyle="#FFFFFF";graphic.moveTo(this.radius,0);var i=0;while(i<this.points.length){graphic.lineTo(this.points[i].x,this.points[i].y);++i}graphic.lineTo(this.radius,0);graphic.fill();graphic.restore()};return AsteroidView}();graphics.AsteroidView=
AsteroidView})(graphics=asteroids.graphics||(asteroids.graphics={}))})(asteroids||(asteroids={}));var asteroids;
(function(asteroids){var graphics;(function(graphics){var Tau=Math.PI*2;var BulletView=function(){function BulletView(graphic){this.x=0;this.y=0;this.width=4;this.height=4;this.rotation=0;this.graphic=null;this.graphic=graphic}BulletView.prototype.draw=function(graphic){graphic.save();graphic.beginPath();graphic.rotate(this.rotation);graphic.fillStyle="#FFFFFF";graphic.arc(~~this.x,~~this.y,2,0,Tau,false);graphic.fill();graphic.restore()};return BulletView}();graphics.BulletView=BulletView})(graphics=
asteroids.graphics||(asteroids.graphics={}))})(asteroids||(asteroids={}));var asteroids;
(function(asteroids){var graphics;(function(graphics){var HudView=function(){function HudView(graphic){var _this=this;this.x=0;this.y=0;this.width=4;this.height=4;this.rotation=0;this.graphic=null;this.score=0;this.lives=3;this.drawScore=null;this.drawLives=null;this.draw=function(graphic){_this.drawScore(graphic);_this.drawLives(graphic)};this.setLives=function(lives){return _this.lives=lives};this.setScore=function(score){return _this.score=score};this.graphic=graphic;this.drawScore=this.createScore;
this.drawLives=this.createLives}HudView.prototype.createLives=function(graphic){graphic.save();graphic.beginPath();graphic.font="bold 18px Helvetica";graphic.fillStyle="#FFFFFF";graphic.textAlign="center";var s="LIVES: "+this.lives;var l=graphic.measureText(s);var x=l.width;var y=20;graphic.fillText(s,~~x,~~y);graphic.fill();graphic.restore()};HudView.prototype.createScore=function(graphic){graphic.save();graphic.beginPath();graphic.font="bold 18px Helvetica";graphic.fillStyle="#FFFFFF";graphic.textAlign=
"center";var s="SCORE: "+this.score;var l=graphic.measureText(s);var x=window.window.innerWidth*window.devicePixelRatio-l.width;var y=20;graphic.fillText(s,~~x,~~y);graphic.fill();graphic.restore()};return HudView}();graphics.HudView=HudView})(graphics=asteroids.graphics||(asteroids.graphics={}))})(asteroids||(asteroids={}));var asteroids;
(function(asteroids){var graphics;(function(graphics){var Point=asteroids.ui.Point;var SpaceshipDeathView=function(){function SpaceshipDeathView(graphic){this.x=0;this.y=0;this.width=20;this.height=20;this.rotation=0;this.r1=0;this.r2=0;this.graphic=null;this.vel1=null;this.vel2=null;this.rot1=null;this.rot2=null;this.x1=0;this.x2=0;this.y1=0;this.y2=0;this.first=true;this.graphic=graphic}SpaceshipDeathView.prototype.animate=function(time){if(this.first){this.first=false;this.vel1=new Point(Math.random()*
10-5,Math.random()*10+10);this.vel2=new Point(Math.random()*10-5,-(Math.random()*10+10));this.rot1=Math.random()*300-150;this.rot2=Math.random()*300-150;this.x1=this.x2=this.x;this.y1=this.y2=this.y;this.r1=this.r2=this.rotation}this.x1+=this.vel1.x*time;this.y1+=this.vel1.y*time;this.r1+=this.rot1*time;this.x2+=this.vel2.x*time;this.y2+=this.vel2.y*time;this.r2+=this.rot2*time;return this.draw(this.graphic)};SpaceshipDeathView.prototype.draw=function(graphic){graphic.save();graphic.beginPath();graphic.translate(~~(this.x+
this.x1),~~(this.y+this.y1));graphic.rotate(this.r1);graphic.fillStyle="#FFFFFF";graphic.moveTo(10,0);graphic.lineTo(-7,7);graphic.lineTo(-4,0);graphic.lineTo(10,0);graphic.fill();graphic.restore();graphic.save();graphic.beginPath();graphic.translate(~~(this.x+this.x2),~~(this.y+this.y2));graphic.rotate(this.r2);graphic.fillStyle="#FFFFFF";graphic.moveTo(10,0);graphic.lineTo(-7,7);graphic.lineTo(-4,0);graphic.lineTo(10,0);graphic.fill();graphic.restore()};return SpaceshipDeathView}();graphics.SpaceshipDeathView=
SpaceshipDeathView})(graphics=asteroids.graphics||(asteroids.graphics={}))})(asteroids||(asteroids={}));var asteroids;
(function(asteroids){var graphics;(function(graphics){var SpaceshipView=function(){function SpaceshipView(graphic){this.x=0;this.y=0;this.width=20;this.height=20;this.rotation=0;this.graphic=null;this.graphic=graphic}SpaceshipView.prototype.draw=function(graphic){graphic.save();graphic.beginPath();graphic.translate(~~this.x,~~this.y);graphic.rotate(this.rotation);graphic.fillStyle="#FFFFFF";graphic.moveTo(10,0);graphic.lineTo(-7,7);graphic.lineTo(-4,0);graphic.lineTo(-7,-7);graphic.lineTo(10,0);graphic.fill();
graphic.restore()};return SpaceshipView}();graphics.SpaceshipView=SpaceshipView})(graphics=asteroids.graphics||(asteroids.graphics={}))})(asteroids||(asteroids={}));var asteroids;
(function(asteroids){var graphics;(function(graphics){var Signal0=artemis.signals.Signal0;var WaitForStartView=function(){function WaitForStartView(graphic){var _this=this;this.x=0;this.y=0;this.width=4;this.height=4;this.rotation=0;this.graphic=null;this.gameOver=null;this.clickToStart=null;this.instructions=null;this.click=null;this.graphic=graphic;this.click=new Signal0;this.gameOver=this.createGameOver;this.instructions=this.createInstructions;this.clickToStart=this.createClickToStart;this.graphic.canvas.addEventListener("click",
function(event){return _this.click.dispatch()})}WaitForStartView.prototype.createGameOver=function(graphic){graphic.save();graphic.beginPath();graphic.font="bold 32px Helvetica";graphic.fillStyle="#FFFFFF";var s="ASTEROIDS";var l=graphic.measureText(s);var x=Math.floor((window.innerWidth*window.devicePixelRatio-l.width)/2);var y=175;graphic.fillText(s,~~x,~~y);graphic.fill();graphic.restore()};WaitForStartView.prototype.createClickToStart=function(graphic){graphic.save();graphic.beginPath();graphic.font=
"bold 18px Helvetica";graphic.fillStyle="#FFFFFF";var s="CLICK TO START";var l=graphic.measureText(s);var x=Math.floor((window.innerWidth*window.devicePixelRatio-l.width)/2);var y=225;graphic.fillText(s,~~x,~~y);graphic.fill();graphic.restore()};WaitForStartView.prototype.createInstructions=function(graphic){graphic.save();graphic.beginPath();graphic.font="bold 14px Helvetica";graphic.fillStyle="#FFFFFF";var s="CTRL-Z to Fire  ~  Arrow Keys to Move";var x=10;var y=window.innerHeight*window.devicePixelRatio-
20;graphic.fillText(s,~~x,~~y);graphic.fill();graphic.restore()};WaitForStartView.prototype.draw=function(graphic){this.gameOver(graphic);this.clickToStart(graphic);this.instructions(graphic)};return WaitForStartView}();graphics.WaitForStartView=WaitForStartView})(graphics=asteroids.graphics||(asteroids.graphics={}))})(asteroids||(asteroids={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var asteroids;
(function(asteroids){var components;(function(components){var Component=artemis.Component;var Animation=function(_super){__extends(Animation,_super);function Animation(){_super.apply(this,arguments)}Animation.prototype.initialize=function(animation){this.animation=animation};Animation.className="Animation";return Animation}(Component);components.Animation=Animation;Animation.prototype.animation=null})(components=asteroids.components||(asteroids.components={}))})(asteroids||(asteroids={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var asteroids;
(function(asteroids){var components;(function(components){var Component=artemis.Component;var Asteroid=function(_super){__extends(Asteroid,_super);function Asteroid(){_super.apply(this,arguments)}Asteroid.prototype.initialize=function(fsm){if(fsm===void 0)fsm=null;this.fsm=fsm};Asteroid.className="Asteroid";return Asteroid}(Component);components.Asteroid=Asteroid;Asteroid.prototype.fsm=null})(components=asteroids.components||(asteroids.components={}))})(asteroids||(asteroids={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var asteroids;
(function(asteroids){var components;(function(components){var Component=artemis.Component;var Audio=function(_super){__extends(Audio,_super);function Audio(){_super.call(this);this.toPlay=[]}Audio.className="Audio";return Audio}(Component);components.Audio=Audio;Audio.prototype.toPlay=null})(components=asteroids.components||(asteroids.components={}))})(asteroids||(asteroids={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var asteroids;
(function(asteroids){var components;(function(components){var PooledComponent=artemis.PooledComponent;var Pooled=artemis.annotations.Pooled;var Bullet=function(_super){__extends(Bullet,_super);function Bullet(){_super.apply(this,arguments)}Bullet.prototype.initialize=function(lifeRemaining){if(lifeRemaining===void 0)lifeRemaining=0;this.lifeRemaining=lifeRemaining};Bullet.className="Bullet";Bullet=__decorate([Pooled()],Bullet);return Bullet}(PooledComponent);components.Bullet=Bullet;Bullet.prototype.lifeRemaining=
0})(components=asteroids.components||(asteroids.components={}))})(asteroids||(asteroids={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var asteroids;
(function(asteroids){var components;(function(components){var PooledComponent=artemis.PooledComponent;var Pooled=artemis.annotations.Pooled;var Collision=function(_super){__extends(Collision,_super);function Collision(){_super.apply(this,arguments)}Collision.prototype.initialize=function(radius){if(radius===void 0)radius=0;this.radius=radius};Collision.className="Collision";Collision=__decorate([Pooled()],Collision);return Collision}(PooledComponent);components.Collision=Collision;Collision.prototype.radius=
0})(components=asteroids.components||(asteroids.components={}))})(asteroids||(asteroids={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var asteroids;
(function(asteroids){var components;(function(components){var Component=artemis.Component;var DeathThroes=function(_super){__extends(DeathThroes,_super);function DeathThroes(){_super.apply(this,arguments)}DeathThroes.prototype.initialize=function(duration,callback){if(duration===void 0)duration=0;this.duration=duration;if(callback)this.callback=callback};DeathThroes.className="DeathThroes";return DeathThroes}(Component);components.DeathThroes=DeathThroes;DeathThroes.prototype.duration=0;DeathThroes.prototype.callback=
null})(components=asteroids.components||(asteroids.components={}))})(asteroids||(asteroids={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var asteroids;
(function(asteroids){var components;(function(components){var PooledComponent=artemis.PooledComponent;var Pooled=artemis.annotations.Pooled;var Display=function(_super){__extends(Display,_super);function Display(){_super.apply(this,arguments)}Display.prototype.initialize=function(sprite){if(sprite===void 0)sprite=null;this.sprite=sprite};Display.className="Display";Display=__decorate([Pooled()],Display);return Display}(PooledComponent);components.Display=Display;Display.prototype.sprite=null})(components=
asteroids.components||(asteroids.components={}))})(asteroids||(asteroids={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var asteroids;
(function(asteroids){var components;(function(components){var Component=artemis.Component;var GameState=function(_super){__extends(GameState,_super);function GameState(){_super.apply(this,arguments)}GameState.prototype.initialize=function(lives,level){if(lives===void 0)lives=0;if(level===void 0)level=0;this.lives=lives;this.level=level;this.hits=0;this.playing=false};GameState.prototype.setForStart=function(){this.lives=3;this.level=0;this.hits=0;this.playing=true};GameState.className="GameState";
return GameState}(Component);components.GameState=GameState;GameState.prototype.lives=0;GameState.prototype.level=0;GameState.prototype.hits=0;GameState.prototype.playing=false})(components=asteroids.components||(asteroids.components={}))})(asteroids||(asteroids={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var asteroids;
(function(asteroids){var components;(function(components){var Component=artemis.Component;var Point=asteroids.ui.Point;var Gun=function(_super){__extends(Gun,_super);function Gun(){_super.apply(this,arguments)}Gun.prototype.initialize=function(offsetX,offsetY,minimumShotInterval,bulletLifetime){this.offsetFromParent=new Point(offsetX,offsetY);this.minimumShotInterval=minimumShotInterval;this.bulletLifetime=bulletLifetime;this.timeSinceLastShot=0;this.shooting=false};Gun.className="Gun";return Gun}(Component);
components.Gun=Gun;Gun.prototype.offsetFromParent=null;Gun.prototype.timeSinceLastShot=0;Gun.prototype.minimumShotInterval=0;Gun.prototype.bulletLifetime=0;Gun.prototype.shooting=false})(components=asteroids.components||(asteroids.components={}))})(asteroids||(asteroids={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var asteroids;
(function(asteroids){var components;(function(components){var Component=artemis.Component;var GunControls=function(_super){__extends(GunControls,_super);function GunControls(){_super.apply(this,arguments)}GunControls.prototype.initialize=function(trigger){if(trigger===void 0)trigger=0;this.trigger=trigger};GunControls.className="GunControls";return GunControls}(Component);components.GunControls=GunControls;GunControls.prototype.trigger=0})(components=asteroids.components||(asteroids.components={}))})(asteroids||
(asteroids={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var asteroids;
(function(asteroids){var components;(function(components){var Component=artemis.Component;var Hud=function(_super){__extends(Hud,_super);function Hud(){_super.apply(this,arguments)}Hud.prototype.initialize=function(view){this.view=view};Hud.className="Hud";return Hud}(Component);components.Hud=Hud;Hud.prototype.view=null})(components=asteroids.components||(asteroids.components={}))})(asteroids||(asteroids={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var asteroids;
(function(asteroids){var components;(function(components){var Point=asteroids.ui.Point;var PooledComponent=artemis.PooledComponent;var Pooled=artemis.annotations.Pooled;var Motion=function(_super){__extends(Motion,_super);function Motion(){_super.apply(this,arguments)}Motion.prototype.initialize=function(velocityX,velocityY,angularVelocity,damping){this.velocity=new Point(velocityX,velocityY);this.angularVelocity=angularVelocity;this.damping=damping};Motion.className="Motion";Motion=__decorate([Pooled()],
Motion);return Motion}(PooledComponent);components.Motion=Motion;Motion.prototype.velocity=null;Motion.prototype.angularVelocity=0;Motion.prototype.damping=0})(components=asteroids.components||(asteroids.components={}))})(asteroids||(asteroids={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var asteroids;
(function(asteroids){var components;(function(components){var Component=artemis.Component;var MotionControls=function(_super){__extends(MotionControls,_super);function MotionControls(){_super.apply(this,arguments)}MotionControls.prototype.initialize=function(left,right,accelerate,accelerationRate,rotationRate){this.left=left;this.right=right;this.accelerate=accelerate;this.accelerationRate=accelerationRate;this.rotationRate=rotationRate};MotionControls.className="MotionControls";return MotionControls}(Component);
components.MotionControls=MotionControls;MotionControls.prototype.left=0;MotionControls.prototype.right=0;MotionControls.prototype.accelerate=0;MotionControls.prototype.accelerationRate=0;MotionControls.prototype.rotationRate=0})(components=asteroids.components||(asteroids.components={}))})(asteroids||(asteroids={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var asteroids;
(function(asteroids){var components;(function(components){var Point=asteroids.ui.Point;var PooledComponent=artemis.PooledComponent;var Pooled=artemis.annotations.Pooled;var Position=function(_super){__extends(Position,_super);function Position(){_super.apply(this,arguments)}Position.prototype.initialize=function(x,y,r){if(r===void 0)r=0;this.position=new Point(x,y);this.rotation=r};Position.className="Position";Position=__decorate([Pooled()],Position);return Position}(PooledComponent);components.Position=
Position;Position.prototype.position=null;Position.prototype.rotation=0})(components=asteroids.components||(asteroids.components={}))})(asteroids||(asteroids={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var asteroids;
(function(asteroids){var components;(function(components){var Component=artemis.Component;var Spaceship=function(_super){__extends(Spaceship,_super);function Spaceship(){_super.apply(this,arguments)}Spaceship.prototype.initialize=function(fsm){if(fsm===void 0)fsm=null;this.fsm=fsm};Spaceship.className="Spaceship";return Spaceship}(Component);components.Spaceship=Spaceship;Spaceship.prototype.fsm=null})(components=asteroids.components||(asteroids.components={}))})(asteroids||(asteroids={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var asteroids;
(function(asteroids){var components;(function(components){var Component=artemis.Component;var WaitForStart=function(_super){__extends(WaitForStart,_super);function WaitForStart(){var _this=this;_super.apply(this,arguments);this.setStartGame=function(){_this.startGame=true}}WaitForStart.prototype.initialize=function(waitForStart){this.waitForStart=waitForStart;this.waitForStart.click.add(this.setStartGame)};WaitForStart.className="WaitForStart";return WaitForStart}(Component);components.WaitForStart=
WaitForStart;WaitForStart.prototype.waitForStart=null;WaitForStart.prototype.startGame=false})(components=asteroids.components||(asteroids.components={}))})(asteroids||(asteroids={}));
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var asteroids;
(function(asteroids){var templates;(function(templates){var EntityTemplate=artemis.annotations.EntityTemplate;var EntitySystem=artemis.EntitySystem;var AsteroidDeathView=asteroids.graphics.AsteroidDeathView;var Asteroid=asteroids.components.Asteroid;var Display=asteroids.components.Display;var Animation=asteroids.components.Animation;var DeathThroes=asteroids.components.DeathThroes;var Position=asteroids.components.Position;var Audio=asteroids.components.Audio;var AsteroidDeathTemplate=function(){function AsteroidDeathTemplate(){}
AsteroidDeathTemplate.prototype.buildEntity=function(entity,world,radius,x,y){var dying=new AsteroidDeathView(EntitySystem.blackBoard.getEntry("2d"),radius);entity.addComponent(Asteroid);entity.addComponent(Display,dying);entity.addComponent(Animation,dying);entity.addComponent(DeathThroes,3);entity.addComponent(Position,x,y);entity.addComponent(Audio);return entity};AsteroidDeathTemplate=__decorate([EntityTemplate("asteroid_death")],AsteroidDeathTemplate);return AsteroidDeathTemplate}();templates.AsteroidDeathTemplate=
AsteroidDeathTemplate})(templates=asteroids.templates||(asteroids.templates={}))})(asteroids||(asteroids={}));
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var asteroids;
(function(asteroids){var templates;(function(templates){var EntityTemplate=artemis.annotations.EntityTemplate;var EntitySystem=artemis.EntitySystem;var GroupManager=artemis.managers.GroupManager;var AsteroidView=asteroids.graphics.AsteroidView;var Constants=asteroids.Constants;var Asteroid=asteroids.components.Asteroid;var Display=asteroids.components.Display;var Position=asteroids.components.Position;var Motion=asteroids.components.Motion;var Collision=asteroids.components.Collision;var Audio=asteroids.components.Audio;
var AsteroidTemplate=function(){function AsteroidTemplate(){}AsteroidTemplate.prototype.buildEntity=function(entity,world,radius,x,y){entity.addComponent(Asteroid);entity.addComponent(Display,new AsteroidView(EntitySystem.blackBoard.getEntry("2d"),radius));entity.addComponent(Position,x,y);entity.addComponent(Motion,(Math.random()-.5)*4*(50-radius),(Math.random()-.5)*4*(50-radius),Math.random()*2-1,0);entity.addComponent(Collision,radius);entity.addComponent(Audio);world.getManager(GroupManager).add(entity,
Constants.Groups.ASTEROIDS);return entity};AsteroidTemplate=__decorate([EntityTemplate("asteroid")],AsteroidTemplate);return AsteroidTemplate}();templates.AsteroidTemplate=AsteroidTemplate})(templates=asteroids.templates||(asteroids.templates={}))})(asteroids||(asteroids={}));
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var asteroids;
(function(asteroids){var templates;(function(templates){var EntityTemplate=artemis.annotations.EntityTemplate;var EntitySystem=artemis.EntitySystem;var GroupManager=artemis.managers.GroupManager;var BulletView=asteroids.graphics.BulletView;var Constants=asteroids.Constants;var Bullet=asteroids.components.Bullet;var Display=asteroids.components.Display;var Position=asteroids.components.Position;var Motion=asteroids.components.Motion;var Collision=asteroids.components.Collision;var BulletTemplate=function(){function BulletTemplate(){}
BulletTemplate.prototype.buildEntity=function(entity,world,gun,parentPosition){var cos=Math.cos(parentPosition.rotation);var sin=Math.sin(parentPosition.rotation);var x=cos*gun.offsetFromParent.x-sin*gun.offsetFromParent.y+parentPosition.position.x;var y=sin*gun.offsetFromParent.x+cos*gun.offsetFromParent.y+parentPosition.position.y;entity.addComponent(Bullet,gun.bulletLifetime);entity.addComponent(Display,new BulletView(EntitySystem.blackBoard.getEntry("2d")));entity.addComponent(Position,x,y,0);
entity.addComponent(Motion,cos*150,sin*150,0,0);entity.addComponent(Collision,0);world.getManager(GroupManager).add(entity,Constants.Groups.BULLETS);return entity};BulletTemplate=__decorate([EntityTemplate("bullet")],BulletTemplate);return BulletTemplate}();templates.BulletTemplate=BulletTemplate})(templates=asteroids.templates||(asteroids.templates={}))})(asteroids||(asteroids={}));
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var asteroids;
(function(asteroids){var templates;(function(templates){var EntityTemplate=artemis.annotations.EntityTemplate;var EntitySystem=artemis.EntitySystem;var TagManager=artemis.managers.TagManager;var HudView=asteroids.graphics.HudView;var Display=asteroids.components.Display;var Position=asteroids.components.Position;var Hud=asteroids.components.Hud;var Constants=asteroids.Constants;var GameTemplate=function(){function GameTemplate(){}GameTemplate.prototype.buildEntity=function(entity,world,state){var hud=
new HudView(EntitySystem.blackBoard.getEntry("2d"));entity.addComponent(state);entity.addComponent(Display,hud);entity.addComponent(Position,0,0);entity.addComponent(Hud,hud);world.getManager(TagManager).register(Constants.Tags.GAME,entity);return entity};GameTemplate=__decorate([EntityTemplate("game")],GameTemplate);return GameTemplate}();templates.GameTemplate=GameTemplate})(templates=asteroids.templates||(asteroids.templates={}))})(asteroids||(asteroids={}));
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var asteroids;
(function(asteroids){var templates;(function(templates){var EntityTemplate=artemis.annotations.EntityTemplate;var EntitySystem=artemis.EntitySystem;var TagManager=artemis.managers.TagManager;var SpaceshipDeathView=asteroids.graphics.SpaceshipDeathView;var Display=asteroids.components.Display;var Animation=asteroids.components.Animation;var DeathThroes=asteroids.components.DeathThroes;var Position=asteroids.components.Position;var Audio=asteroids.components.Audio;var Constants=asteroids.Constants;
var SpaceshipDeathTemplate=function(){function SpaceshipDeathTemplate(){}SpaceshipDeathTemplate.prototype.buildEntity=function(entity,world,x,y){var dying=new SpaceshipDeathView(EntitySystem.blackBoard.getEntry("2d"));var death=new DeathThroes;death.initialize(5,function(){world.getManager(TagManager).unregister(Constants.Tags.SPACESHIP)});entity.addComponent(Display,dying);entity.addComponent(Animation,dying);entity.addComponent(death);entity.addComponent(Position,x,y);entity.addComponent(Audio);
world.getManager(TagManager).register(Constants.Tags.SPACESHIP,entity);return entity};SpaceshipDeathTemplate=__decorate([EntityTemplate("spaceship_death")],SpaceshipDeathTemplate);return SpaceshipDeathTemplate}();templates.SpaceshipDeathTemplate=SpaceshipDeathTemplate})(templates=asteroids.templates||(asteroids.templates={}))})(asteroids||(asteroids={}));
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var asteroids;
(function(asteroids){var templates;(function(templates){var EntityTemplate=artemis.annotations.EntityTemplate;var EntitySystem=artemis.EntitySystem;var GroupManager=artemis.managers.GroupManager;var SpaceshipView=asteroids.graphics.SpaceshipView;var Spaceship=asteroids.components.Spaceship;var Constants=asteroids.Constants;var Display=asteroids.components.Display;var Position=asteroids.components.Position;var Motion=asteroids.components.Motion;var MotionControls=asteroids.components.MotionControls;
var Collision=asteroids.components.Collision;var Gun=asteroids.components.Gun;var GunControls=asteroids.components.GunControls;var Audio=asteroids.components.Audio;var KEY_LEFT=37;var KEY_UP=38;var KEY_RIGHT=39;var KEY_Z=90;var SpaceshipTemplate=function(){function SpaceshipTemplate(){}SpaceshipTemplate.prototype.buildEntity=function(entity,world){entity.addComponent(Spaceship);entity.addComponent(Display,new SpaceshipView(EntitySystem.blackBoard.getEntry("2d")));entity.addComponent(Position,300,
225,0);entity.addComponent(Motion,0,0,0,15);entity.addComponent(MotionControls,KEY_LEFT,KEY_RIGHT,KEY_UP,100,3);entity.addComponent(Gun,8,0,.3,2);entity.addComponent(GunControls,KEY_Z);entity.addComponent(Collision,9);entity.addComponent(Audio);world.getManager(GroupManager).add(entity,Constants.Groups.SPACESHIP);return entity};SpaceshipTemplate=__decorate([EntityTemplate("spaceship")],SpaceshipTemplate);return SpaceshipTemplate}();templates.SpaceshipTemplate=SpaceshipTemplate})(templates=asteroids.templates||
(asteroids.templates={}))})(asteroids||(asteroids={}));
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var asteroids;
(function(asteroids){var templates;(function(templates){var EntityTemplate=artemis.annotations.EntityTemplate;var EntitySystem=artemis.EntitySystem;var TagManager=artemis.managers.TagManager;var WaitForStartView=asteroids.graphics.WaitForStartView;var WaitForStart=asteroids.components.WaitForStart;var Display=asteroids.components.Display;var Position=asteroids.components.Position;var WaitTemplate=function(){function WaitTemplate(){}WaitTemplate.prototype.buildEntity=function(entity,world,state){var waitView=
new WaitForStartView(EntitySystem.blackBoard.getEntry("2d"));entity.addComponent(state);entity.addComponent(WaitForStart,waitView,false);entity.addComponent(Display,waitView);entity.addComponent(Position,0,0);world.getManager(TagManager).register(asteroids.Constants.Tags.START,entity);return entity};WaitTemplate=__decorate([EntityTemplate("start_game")],WaitTemplate);return WaitTemplate}();templates.WaitTemplate=WaitTemplate})(templates=asteroids.templates||(asteroids.templates={}))})(asteroids||
(asteroids={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var asteroids;
(function(asteroids){var systems;(function(systems){var Animation=asteroids.components.Animation;var Mapper=artemis.annotations.Mapper;var EntityProcessingSystem=artemis.systems.EntityProcessingSystem;var Aspect=artemis.Aspect;var AnimationSystem=function(_super){__extends(AnimationSystem,_super);function AnimationSystem(){_super.call(this,Aspect.getAspectForAll(Animation))}AnimationSystem.prototype.processEach=function(e){var animation=this.am.get(e).animation;animation.animate(this.world.getDelta())};
__decorate([Mapper(Animation)],AnimationSystem.prototype,"am");return AnimationSystem}(EntityProcessingSystem);systems.AnimationSystem=AnimationSystem})(systems=asteroids.systems||(asteroids.systems={}))})(asteroids||(asteroids={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var asteroids;
(function(asteroids){var systems;(function(systems){var Audio=asteroids.components.Audio;var Mapper=artemis.annotations.Mapper;var EntityProcessingSystem=artemis.systems.EntityProcessingSystem;var Aspect=artemis.Aspect;var AudioSystem=function(_super){__extends(AudioSystem,_super);function AudioSystem(){_super.call(this,Aspect.getAspectForAll(Audio))}AudioSystem.prototype.processEach=function(e){var audio=this.am.get(e);for(var i in audio.toPlay){var Type=audio.toPlay[i];var sound=new Type;sound.play(0,
1)}audio.toPlay.length=0};__decorate([Mapper(Audio)],AudioSystem.prototype,"am");return AudioSystem}(EntityProcessingSystem);systems.AudioSystem=AudioSystem})(systems=asteroids.systems||(asteroids.systems={}))})(asteroids||(asteroids={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var asteroids;
(function(asteroids){var systems;(function(systems){var Bullet=asteroids.components.Bullet;var Mapper=artemis.annotations.Mapper;var EntityProcessingSystem=artemis.systems.EntityProcessingSystem;var Aspect=artemis.Aspect;var BulletAgeSystem=function(_super){__extends(BulletAgeSystem,_super);function BulletAgeSystem(){_super.call(this,Aspect.getAspectForAll(Bullet))}BulletAgeSystem.prototype.processEach=function(e){var time=this.world.getDelta();var bullet=this.bm.get(e);bullet.lifeRemaining-=time;
if(bullet.lifeRemaining<=0)this.world.deleteEntity(e)};__decorate([Mapper(Bullet)],BulletAgeSystem.prototype,"bm");return BulletAgeSystem}(EntityProcessingSystem);systems.BulletAgeSystem=BulletAgeSystem})(systems=asteroids.systems||(asteroids.systems={}))})(asteroids||(asteroids={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var asteroids;
(function(asteroids){var systems;(function(systems){var Collision=asteroids.components.Collision;var GameState=asteroids.components.GameState;var Position=asteroids.components.Position;var Aspect=artemis.Aspect;var Bag=artemis.utils.Bag;var EntitySystem=artemis.EntitySystem;var GroupManager=artemis.managers.GroupManager;var Mapper=artemis.annotations.Mapper;var CollisionSystem=function(_super){__extends(CollisionSystem,_super);function CollisionSystem(){_super.call(this,Aspect.getAspectForAll(GameState))}
CollisionSystem.prototype.initialize=function(){var _this=this;this.collisionPairs=new Bag;this.collisionPairs.add(new CollisionPair(this,asteroids.Constants.Groups.BULLETS,asteroids.Constants.Groups.ASTEROIDS,{handleCollision:function(game,bullet,asteroid){var c1=_this.cm.get(asteroid);var p1=_this.pm.get(asteroid).position;if(c1.radius>10){var r1=c1.radius-10;var x1=p1.x+Math.random()*10-5;var y1=p1.y+Math.random()*10-5;_this.world.createEntityFromTemplate("asteroid",r1,x1,y1).addToWorld();x1=p1.x+
Math.random()*10-5;y1=p1.y+Math.random()*10-5;_this.world.createEntityFromTemplate("asteroid",r1,x1,y1).addToWorld()}bullet.deleteFromWorld();asteroid.deleteFromWorld();_this.gm.get(game).hits++;_this.world.createEntityFromTemplate("asteroid_death",c1.radius,p1.x,p1.y).addToWorld()}}));this.collisionPairs.add(new CollisionPair(this,asteroids.Constants.Groups.ASTEROIDS,asteroids.Constants.Groups.SPACESHIP,{handleCollision:function(game,asteroid,spaceship){var p=_this.pm.get(spaceship).position;spaceship.deleteFromWorld();
var e=_this.world.createEntityFromTemplate("spaceship_death",p.x,p.y);e.addToWorld();_this.gm.get(game).lives--}}))};CollisionSystem.prototype.processEntities=function(entities){var e=entities.get(0);for(var i=0;this.collisionPairs.size()>i;i++)this.collisionPairs.get(i).checkForCollisions(e)};CollisionSystem.prototype.checkProcessing=function(){return true};__decorate([Mapper(GameState)],CollisionSystem.prototype,"gm");__decorate([Mapper(Position)],CollisionSystem.prototype,"pm");__decorate([Mapper(Collision)],
CollisionSystem.prototype,"cm");return CollisionSystem}(EntitySystem);systems.CollisionSystem=CollisionSystem;var CollisionPair=function(){function CollisionPair(parent,group1,group2,handler){this.parent=parent;this.groupEntitiesA=parent.world.getManager(GroupManager).getEntities(group1);this.groupEntitiesB=parent.world.getManager(GroupManager).getEntities(group2);this.handler=handler}CollisionPair.prototype.checkForCollisions=function(e){for(var a=0;this.groupEntitiesA.size()>a;a++){var entityA=
this.groupEntitiesA.get(a);for(var b=0;this.groupEntitiesB.size()>b;b++){var entityB=this.groupEntitiesB.get(b);if(this.collisionExists(entityA,entityB))this.handler.handleCollision(e,entityA,entityB)}}};CollisionPair.prototype.collisionExists=function(e1,e2){if(e1===null||e2===null)return false;var p1=this.parent.pm.get(e1).position;var p2=this.parent.pm.get(e2).position;var b1=this.parent.cm.get(e1);var b2=this.parent.cm.get(e2);var a=p1.x-p2.x;var b=p1.y-p2.y;return Math.sqrt(a*a+b*b)-b1.radius<
b2.radius};return CollisionPair}()})(systems=asteroids.systems||(asteroids.systems={}))})(asteroids||(asteroids={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var asteroids;
(function(asteroids){var systems;(function(systems){var DeathThroes=asteroids.components.DeathThroes;var Mapper=artemis.annotations.Mapper;var EntityProcessingSystem=artemis.systems.EntityProcessingSystem;var Aspect=artemis.Aspect;var DeathThroesSystem=function(_super){__extends(DeathThroesSystem,_super);function DeathThroesSystem(){_super.call(this,Aspect.getAspectForAll(DeathThroes))}DeathThroesSystem.prototype.processEach=function(e){var time=this.world.getDelta();var death=this.dm.get(e);death.duration-=
time;if(death.duration<=0){if(death.callback)death.callback(e);this.world.deleteEntity(e)}};__decorate([Mapper(DeathThroes)],DeathThroesSystem.prototype,"dm");return DeathThroesSystem}(EntityProcessingSystem);systems.DeathThroesSystem=DeathThroesSystem})(systems=asteroids.systems||(asteroids.systems={}))})(asteroids||(asteroids={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var asteroids;
(function(asteroids_1){var systems;(function(systems){var Mapper=artemis.annotations.Mapper;var GroupManager=artemis.managers.GroupManager;var TagManager=artemis.managers.TagManager;var EntitySystem=artemis.EntitySystem;var Aspect=artemis.Aspect;var Point=asteroids.ui.Point;var GameState=asteroids.components.GameState;var Position=asteroids.components.Position;var Collision=asteroids.components.Collision;var Constants=asteroids.Constants;var GameManager=function(_super){__extends(GameManager,_super);
function GameManager(config){_super.call(this,Aspect.getAspectForAll(GameState));this.config=null;this.config=config}GameManager.prototype.initialize=function(){this.tags=this.world.getManager(TagManager);this.groups=this.world.getManager(GroupManager)};GameManager.prototype.processEntities=function(entities){for(var i=0,k=entities.size();i<k;i++)this.processEach(entities.get(i))};GameManager.prototype.processEach=function(e){if(this.tags.isRegistered(Constants.Tags.SPACESHIP))return;var game=this.gm.get(e);
if(game.playing){var ships=this.groups.getEntities(Constants.Groups.SPACESHIP);if(ships.isEmpty()){if(game.lives>0){var newSpaceshipPosition=new Point(this.config.width*.5,this.config.height*.5);var clearToAddSpaceship=true;var asteroids=this.groups.getEntities(Constants.Groups.ASTEROIDS);for(var i=0,k=asteroids.size();i<k;i++){var asteroid=asteroids.get(i);var position=asteroid.getComponentByType(Position);var collision=asteroid.getComponentByType(Collision);if(Point.distance(position.position,newSpaceshipPosition)<=
collision.radius+50){clearToAddSpaceship=false;break}}if(clearToAddSpaceship)this.world.createEntityFromTemplate("spaceship").addToWorld()}}else{var ship=ships.get(0);var shipPos=ship.getComponentByType(Position);var asteroids=this.groups.getEntities(Constants.Groups.ASTEROIDS);var bullets=this.groups.getEntities(Constants.Groups.BULLETS);if(asteroids.isEmpty()&&bullets.isEmpty()){game.level++;var asteroidCount=2+game.level;for(i=0;i<asteroidCount;i++){while(true){var p=new Point(Math.random()*this.config.width,
Math.random()*this.config.height);if(!(Point.distance(p,shipPos.position)<=80))break}this.world.createEntityFromTemplate("asteroid",30,p.x,p.y).addToWorld()}}}}};__decorate([Mapper(GameState)],GameManager.prototype,"gm");return GameManager}(EntitySystem);systems.GameManager=GameManager})(systems=asteroids_1.systems||(asteroids_1.systems={}))})(asteroids||(asteroids={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var asteroids;
(function(asteroids){var systems;(function(systems){var Mapper=artemis.annotations.Mapper;var EntityProcessingSystem=artemis.systems.EntityProcessingSystem;var Aspect=artemis.Aspect;var Audio=asteroids.components.Audio;var GunControls=asteroids.components.GunControls;var Gun=asteroids.components.Gun;var Position=asteroids.components.Position;var GunControlSystem=function(_super){__extends(GunControlSystem,_super);function GunControlSystem(keyPoll){_super.call(this,Aspect.getAspectForAll(GunControls,
Gun,Position));this.keyPoll=keyPoll}GunControlSystem.prototype.processEach=function(e){var time=this.world.getDelta();var control=this.cm.get(e);var position=this.pm.get(e);var gun=this.gm.get(e);gun.shooting=this.keyPoll.isDown(control.trigger);gun.timeSinceLastShot+=time;if(gun.shooting&&gun.timeSinceLastShot>=gun.minimumShotInterval){this.world.createEntityFromTemplate("bullet",gun,position).addToWorld();gun.timeSinceLastShot=0}};__decorate([Mapper(Audio)],GunControlSystem.prototype,"am");__decorate([Mapper(GunControls)],
GunControlSystem.prototype,"cm");__decorate([Mapper(Gun)],GunControlSystem.prototype,"gm");__decorate([Mapper(Position)],GunControlSystem.prototype,"pm");return GunControlSystem}(EntityProcessingSystem);systems.GunControlSystem=GunControlSystem})(systems=asteroids.systems||(asteroids.systems={}))})(asteroids||(asteroids={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var asteroids;
(function(asteroids){var systems;(function(systems){var Mapper=artemis.annotations.Mapper;var EntityProcessingSystem=artemis.systems.EntityProcessingSystem;var Aspect=artemis.Aspect;var GameState=asteroids.components.GameState;var Hud=asteroids.components.Hud;var HudSystem=function(_super){__extends(HudSystem,_super);function HudSystem(){_super.call(this,Aspect.getAspectForAll(GameState,Hud))}HudSystem.prototype.processEach=function(e){var state=this.gm.get(e);var hud=this.hm.get(e);hud.view.setLives(state.lives);
hud.view.setScore(state.hits)};__decorate([Mapper(GameState)],HudSystem.prototype,"gm");__decorate([Mapper(Hud)],HudSystem.prototype,"hm");return HudSystem}(EntityProcessingSystem);systems.HudSystem=HudSystem})(systems=asteroids.systems||(asteroids.systems={}))})(asteroids||(asteroids={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var asteroids;
(function(asteroids){var systems;(function(systems){var Mapper=artemis.annotations.Mapper;var EntityProcessingSystem=artemis.systems.EntityProcessingSystem;var Aspect=artemis.Aspect;var MotionControls=asteroids.components.MotionControls;var Position=asteroids.components.Position;var Motion=asteroids.components.Motion;var MotionControlSystem=function(_super){__extends(MotionControlSystem,_super);function MotionControlSystem(keyPoll){_super.call(this,Aspect.getAspectForAll(MotionControls,Position,Motion));
this.keyPoll=keyPoll}MotionControlSystem.prototype.processEach=function(e){var time=this.world.getDelta();var control=this.cm.get(e);var position=this.pm.get(e);var motion=this.mm.get(e);var left=this.keyPoll.isDown(control.left);var right=this.keyPoll.isDown(control.right);if(left)position.rotation-=control.rotationRate*time;if(right)position.rotation+=control.rotationRate*time;if(this.keyPoll.isDown(control.accelerate)){motion.velocity.x+=Math.cos(position.rotation)*control.accelerationRate*time;
motion.velocity.y+=Math.sin(position.rotation)*control.accelerationRate*time}};__decorate([Mapper(MotionControls)],MotionControlSystem.prototype,"cm");__decorate([Mapper(Position)],MotionControlSystem.prototype,"pm");__decorate([Mapper(Motion)],MotionControlSystem.prototype,"mm");return MotionControlSystem}(EntityProcessingSystem);systems.MotionControlSystem=MotionControlSystem})(systems=asteroids.systems||(asteroids.systems={}))})(asteroids||(asteroids={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var asteroids;
(function(asteroids){var systems;(function(systems){var Position=asteroids.components.Position;var Motion=asteroids.components.Motion;var Mapper=artemis.annotations.Mapper;var EntityProcessingSystem=artemis.systems.EntityProcessingSystem;var Aspect=artemis.Aspect;var MovementSystem=function(_super){__extends(MovementSystem,_super);function MovementSystem(config){_super.call(this,Aspect.getAspectForAll(Position,Motion));this.config=null;this.config=config}MovementSystem.prototype.processEach=function(e){var time=
this.world.getDelta();var position=this.pm.get(e);var motion=this.mm.get(e);position.position.x+=motion.velocity.x*time;position.position.y+=motion.velocity.y*time;if(position.position.x<0)position.position.x+=this.config.width;if(position.position.x>this.config.width)position.position.x-=this.config.width;if(position.position.y<0)position.position.y+=this.config.height;if(position.position.y>this.config.height)position.position.y-=this.config.height;position.rotation+=motion.angularVelocity*time;
if(motion.damping>0){var xDamp=Math.abs(Math.cos(position.rotation)*motion.damping*time);var yDamp=Math.abs(Math.sin(position.rotation)*motion.damping*time);if(motion.velocity.x>xDamp)motion.velocity.x-=xDamp;else if(motion.velocity.x<-xDamp)motion.velocity.x+=xDamp;else motion.velocity.x=0;if(motion.velocity.y>yDamp)motion.velocity.y-=yDamp;else if(motion.velocity.y<-yDamp)motion.velocity.y+=yDamp;else motion.velocity.y=0}};__decorate([Mapper(Position)],MovementSystem.prototype,"pm");__decorate([Mapper(Motion)],
MovementSystem.prototype,"mm");return MovementSystem}(EntityProcessingSystem);systems.MovementSystem=MovementSystem})(systems=asteroids.systems||(asteroids.systems={}))})(asteroids||(asteroids={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var asteroids;
(function(asteroids){var systems;(function(systems){var Position=asteroids.components.Position;var Display=asteroids.components.Display;var Mapper=artemis.annotations.Mapper;var EntitySystem=artemis.EntitySystem;var Aspect=artemis.Aspect;var DOUBLE_BUFFERING=location.search==="?b=2";console.log("Using DOUBLE_BUFFERING",DOUBLE_BUFFERING);var RenderSystem=function(_super){__extends(RenderSystem,_super);function RenderSystem(graphic,config){_super.call(this,Aspect.getAspectForAll(Position,Display));
this.config=config;this.graphic=graphic;if(DOUBLE_BUFFERING){this.screen=graphic;this.canvas=document.createElement("canvas");this.graphic=this.canvas.getContext("2d");this.canvas.width=config.width;this.canvas.height=config.height}}RenderSystem.prototype.processEntities=function(entities){this.graphic.clearRect(0,0,this.config.width,this.config.height);for(var i=0,k=entities.size();i<k;i++)this.processEach(entities.get(i));if(DOUBLE_BUFFERING){this.screen.clearRect(0,0,this.config.width,this.config.height);
this.screen.drawImage(this.canvas,0,0)}};RenderSystem.prototype.processEach=function(e){var position=this.pm.get(e);var display=this.dm.get(e);var sprite=display.sprite;sprite.x=position.position.x;sprite.y=position.position.y;sprite.rotation=position.rotation;sprite.draw(this.graphic)};__decorate([Mapper(Position)],RenderSystem.prototype,"pm");__decorate([Mapper(Display)],RenderSystem.prototype,"dm");return RenderSystem}(EntitySystem);systems.RenderSystem=RenderSystem})(systems=asteroids.systems||
(asteroids.systems={}))})(asteroids||(asteroids={}));var asteroids;
(function(asteroids){var systems;(function(systems){(function(SystemPriorities){SystemPriorities[SystemPriorities["unknown"]=0]="unknown";SystemPriorities[SystemPriorities["preUpdate"]=1]="preUpdate";SystemPriorities[SystemPriorities["update"]=2]="update";SystemPriorities[SystemPriorities["move"]=3]="move";SystemPriorities[SystemPriorities["resolveCollisions"]=4]="resolveCollisions";SystemPriorities[SystemPriorities["stateMachines"]=5]="stateMachines";SystemPriorities[SystemPriorities["animate"]=
6]="animate";SystemPriorities[SystemPriorities["render"]=7]="render"})(systems.SystemPriorities||(systems.SystemPriorities={}));var SystemPriorities=systems.SystemPriorities})(systems=asteroids.systems||(asteroids.systems={}))})(asteroids||(asteroids={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var asteroids;
(function(asteroids){var systems;(function(systems){var WaitForStart=asteroids.components.WaitForStart;var GameState=asteroids.components.GameState;var Mapper=artemis.annotations.Mapper;var EntityProcessingSystem=artemis.systems.EntityProcessingSystem;var Aspect=artemis.Aspect;var WaitForStartSystem=function(_super){__extends(WaitForStartSystem,_super);function WaitForStartSystem(){_super.call(this,Aspect.getAspectForAll(WaitForStart,GameState))}WaitForStartSystem.prototype.processEach=function(e){var wait=
this.wm.get(e);if(wait.startGame){var game=this.gm.get(e);game.setForStart();wait.startGame=false;this.world.deleteEntity(e)}};__decorate([Mapper(WaitForStart)],WaitForStartSystem.prototype,"wm");__decorate([Mapper(GameState)],WaitForStartSystem.prototype,"gm");return WaitForStartSystem}(EntityProcessingSystem);systems.WaitForStartSystem=WaitForStartSystem})(systems=asteroids.systems||(asteroids.systems={}))})(asteroids||(asteroids={}));var asteroids;
(function(asteroids){var GameConfig=function(){function GameConfig(width,height){this.width=0;this.height=0;this.width=width;this.height=height}return GameConfig}();asteroids.GameConfig=GameConfig})(asteroids||(asteroids={}));var asteroids;
(function(asteroids){var AnimationSystem=asteroids.systems.AnimationSystem;var AudioSystem=asteroids.systems.AudioSystem;var BulletAgeSystem=asteroids.systems.BulletAgeSystem;var CollisionSystem=asteroids.systems.CollisionSystem;var DeathThroesSystem=asteroids.systems.DeathThroesSystem;var GameManager=asteroids.systems.GameManager;var GunControlSystem=asteroids.systems.GunControlSystem;var HudSystem=asteroids.systems.HudSystem;var MotionControlSystem=asteroids.systems.MotionControlSystem;var MovementSystem=
asteroids.systems.MovementSystem;var RenderSystem=asteroids.systems.RenderSystem;var WaitForStartSystem=asteroids.systems.WaitForStartSystem;var GameState=asteroids.components.GameState;var GameConfig=asteroids.GameConfig;var KeyPoll=asteroids.ui.KeyPoll;var TrigLUT=artemis.utils.TrigLUT;var World=artemis.World;var EntitySystem=artemis.EntitySystem;var GroupManager=artemis.managers.GroupManager;var TagManager=artemis.managers.TagManager;var Asteroids=function(){function Asteroids(graphic,width,height){TrigLUT.init(true);
EntitySystem.blackBoard.setEntry("2d",graphic);this.graphic=graphic;this.prepare(width,height)}Asteroids.prototype.prepare=function(width,height){var world=this.world=new World;var state=this.state=new GameState;var keyPoll=this.keyPoll=new KeyPoll(window);var config=this.config=new GameConfig(width,height);world.setManager(new GroupManager);world.setManager(new TagManager);world.setSystem(new WaitForStartSystem);world.setSystem(new GameManager(config));world.setSystem(new MotionControlSystem(keyPoll));
world.setSystem(new GunControlSystem(keyPoll));world.setSystem(new BulletAgeSystem);world.setSystem(new DeathThroesSystem);world.setSystem(new MovementSystem(config));world.setSystem(new CollisionSystem);world.setSystem(new AnimationSystem);world.setSystem(new HudSystem);this.renderSystem=world.setSystem(new RenderSystem(this.graphic,config),true);world.setSystem(new AudioSystem);world.initialize();world.createEntityFromTemplate("start_game",state).addToWorld();world.createEntityFromTemplate("game",
state).addToWorld();state.initialize()};Asteroids.prototype.start=function(){var _this=this;var x,y;if(navigator["isCocoonJS"])this.monitor=null;else{x=Math.floor(this.config.width/2)-40;y=0;this.monitor=new window["Stats"];this.monitor["setMode"](0);this.monitor["domElement"].style.position="absolute";this.monitor["domElement"].style.left=x+"px";this.monitor["domElement"].style.top=y+"px";document.body.appendChild(this.monitor["domElement"])}var temp=0;var previousTime=0;var update=function(delta){temp=
previousTime||delta;previousTime=delta;_this.monitor.begin();_this.world.setDelta((delta-temp)*.001);_this.world.process();_this.renderSystem.process();requestAnimationFrame(update);_this.monitor.end()};requestAnimationFrame(update)};return Asteroids}();asteroids.Asteroids=Asteroids})(asteroids||(asteroids={}));var asteroids;
(function(asteroids){var Asteroids=asteroids.Asteroids;var Main=function(){function Main(){var canvas=Main.createCanvas();(new Asteroids(canvas.getContext("2d"),canvas.width,canvas.height)).start()}Main.createCanvas=function(){var canvas;canvas=document.createElement(navigator["isCocoonJS"]?"screencanvas":"canvas");canvas.width=window.innerWidth*window.devicePixelRatio;canvas.height=window.innerHeight*window.devicePixelRatio;canvas.style.width="100%";canvas.style.height="100%";canvas.style.backgroundColor=
"#000000";document.body.appendChild(canvas);return canvas};return Main}();asteroids.Main=Main})(asteroids||(asteroids={}));new asteroids.Main;
